"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[3257],{3475:(n,e,i)=>{i.r(e),i.d(e,{assets:()=>r,contentTitle:()=>c,default:()=>p,frontMatter:()=>t,metadata:()=>a,toc:()=>o});var s=i(5893),d=i(1151);const t={sidebar_position:3},c="\u6ce2\u8f6e\u5f00\u5173\u9002\u914d\u6307\u5357",a={id:"V853/part2/02-3_PulleySwitchAdaptationGuide",title:"\u6ce2\u8f6e\u5f00\u5173\u9002\u914d\u6307\u5357",description:"0.\u524d\u8a00",source:"@site/docs/V853/part2/02-3_PulleySwitchAdaptationGuide.md",sourceDirName:"V853/part2",slug:"/V853/part2/02-3_PulleySwitchAdaptationGuide",permalink:"/docs/V853/part2/02-3_PulleySwitchAdaptationGuide",draft:!1,unlisted:!1,editUrl:"https://github.com/100askTeam/AllwinnerVisionIC-Docs/tree/main/docs/V853/part2/02-3_PulleySwitchAdaptationGuide.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"v853Sidebar",previous:{title:"MIPI\u663e\u793a\u5c4f\u9002\u914d\u6307\u5357",permalink:"/docs/V853/part2/02-2_MIPIDisplayAdaptationGuide"},next:{title:"MIPI\u6444\u50cf\u5934\u9002\u914d\u6307\u5357",permalink:"/docs/V853/part2/02-4_MIPICameraAdaptationGuide"}},r={},o=[{value:"0.\u524d\u8a00",id:"0\u524d\u8a00",level:2},{value:"1.V853\u529f\u80fd\u6309\u952e\u539f\u7406",id:"1v853\u529f\u80fd\u6309\u952e\u539f\u7406",level:2},{value:"2.GPADC\u9a71\u52a8",id:"2gpadc\u9a71\u52a8",level:2},{value:"3.GPADC\u5185\u6838\u914d\u7f6e",id:"3gpadc\u5185\u6838\u914d\u7f6e",level:2},{value:"4.GPADC\u8bbe\u5907\u6811\u914d\u7f6e",id:"4gpadc\u8bbe\u5907\u6811\u914d\u7f6e",level:2},{value:"5.\u589e\u52a0getevent\u6d4b\u8bd5\u5305",id:"5\u589e\u52a0getevent\u6d4b\u8bd5\u5305",level:2},{value:"6.\u7f16\u8bd1\u3001\u6253\u5305\u548c\u70e7\u5199",id:"6\u7f16\u8bd1\u6253\u5305\u548c\u70e7\u5199",level:2},{value:"7.\u7f16\u5199\u4e00\u4e2a\u6d4b\u8bd5\u5e94\u7528\u7a0b\u5e8f",id:"7\u7f16\u5199\u4e00\u4e2a\u6d4b\u8bd5\u5e94\u7528\u7a0b\u5e8f",level:2},{value:"8.\u7f16\u8bd1\u5e94\u7528\u7a0b\u5e8f\u5e76\u8fdb\u884c\u6d4b\u8bd5",id:"8\u7f16\u8bd1\u5e94\u7528\u7a0b\u5e8f\u5e76\u8fdb\u884c\u6d4b\u8bd5",level:2}];function l(n){const e={code:"code",h1:"h1",h2:"h2",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",...(0,d.a)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.h1,{id:"\u6ce2\u8f6e\u5f00\u5173\u9002\u914d\u6307\u5357",children:"\u6ce2\u8f6e\u5f00\u5173\u9002\u914d\u6307\u5357"}),"\n",(0,s.jsx)(e.h2,{id:"0\u524d\u8a00",children:"0.\u524d\u8a00"}),"\n",(0,s.jsx)(e.p,{children:"\u200b\tDongshanPI-AICT\u5f00\u53d1\u677f\u4e0a\u6709\u6ce2\u8f6e\u5f00\u5173\uff0c\u672c\u7ae0\u8282\u8ddf\u5927\u5bb6\u8ba8\u8bba\u5982\u4f55\u4f7f\u80fd\u6ce2\u8f6e\u5f00\u5173\u3002"}),"\n",(0,s.jsx)(e.h2,{id:"1v853\u529f\u80fd\u6309\u952e\u539f\u7406",children:"1.V853\u529f\u80fd\u6309\u952e\u539f\u7406"}),"\n",(0,s.jsx)(e.p,{children:"\u200b\tDongshanPI-AICT\u5f00\u53d1\u677f\u4e0a\u63d0\u4f9b\u7684\u6ce2\u8f6e\u5f00\u5173\u662f\u901a\u8fc7GPADC\u9ad8\u7cbe\u5ea6\u6570\u6a21\u8f6c\u6362\u6a21\u5757\u6a21\u62df\u51fa5\u4e2a\u529f\u80fd\u6309\u952e\u3002GPADC \u662f 12bit"}),"\n",(0,s.jsx)(e.p,{children:"\u5206\u8fa8\u7387\uff0c8 \u4f4d\u91c7\u96c6\u7cbe\u5ea6\u7684\u6a21\u6570\u8f6c\u6362\u6a21\u5757\uff0c\u5177\u4f53\u901a\u9053\u6570\u53ef\u4ee5\u67e5\u770b\u5bf9\u5e94\u7684 spec \u8bf4\u660e\u2f42\u6863\uff0c\u6a21\u62df\u8f93\u2f0a\u8303 \u56f4 0\u301c1.8V\uff0c\u6700\u2fbc\u91c7\u6837\u7387"}),"\n",(0,s.jsx)(e.p,{children:"1MHz\uff0c\u5e76\u4e14\u2f40\u6301\u6570\u636e\u2f50\u8f83\uff0c\u2f83\u6821\u9a8c\u529f\u80fd\uff0c\u540c\u65f6\u2f2f\u4f5c\u4e8e\u53ef\u914d\u7f6e\u2f00\u4e0b\u2f2f\u4f5c\u6a21\u5f0f\uff1a"}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsx)(e.li,{children:"Single mode\uff1a\u5728\u6307\u5b9a\u7684\u901a\u9053\u5b8c\u6210\u2f00\u6b21\u8f6c\u6362\u5e76\u5c06\u6570\u636e\u653e\u5728\u5bf9\u5e94\u6570\u636e\u5bc4\u5b58\u5668\u4e2d\uff1b"}),"\n",(0,s.jsx)(e.li,{children:"Single-cycle mode\uff1a\u5728\u6307\u5b9a\u7684\u901a\u9053\u5b8c\u6210\u2f00\u4e2a\u5468\u671f\u8f6c\u6362\u5e76\u5c06\u6570\u636e\u653e\u5728\u54cd\u5e94\u6570\u636e\u5bc4\u5b58\u5668\u4e2d;"}),"\n",(0,s.jsx)(e.li,{children:"Continuous mode\uff1a\u5728\u6307\u5b9a\u7684\u901a\u9053\u6301\u7eed\u8f6c\u6362\u5e76\u5c06\u6570\u636e\u653e\u5728\u54cd\u5e94\u6570\u636e\u5bc4\u5b58\u5668\u4e2d\uff1b"}),"\n",(0,s.jsx)(e.li,{children:"Burst mode\uff1a\u8fb9\u91c7\u6837\u8fb9\u8f6c\u6362\u5e76\u5c06\u6570\u636e\u653e\u2f0a 32 \u5b57\u8282\u7684 FIFO\uff0c\u2f40\u6301\u4e2d\u65ad\u63a7\u5236\u3002"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{alt:"image-20230417172938775",src:i(9524).Z+"",width:"806",height:"271"})}),"\n",(0,s.jsx)(e.p,{children:"\u200b\t\u90e8\u5206 GPADC \u63a5\u2f1d\u4e5f\u5f00\u59cb\u6162\u6162\u2f64\u4e8e KEY \u6a21\u5757\u6309\u952e\u7684\u8bfb\u53d6\uff0c\u2f00\u822c\u5305\u62ec VOL+\u3001VOL-\u3001HOME\u3001MENU\u3001ENTER \u7b49\u7b49\uff0c GPADC0 \u2f64\u4e8e KEY \u7684\u7535\u8def\u5982\u4e0a\u56fe\u3002 AVCC-AP \u4e3a 1.8V \u7684\u4f9b\u7535\uff0c\u4e0d\u540c\u7684\u6309\u952e\u6309\u4e0b\uff0cGPADC0 \u2f1d\u7684\u7535\u538b\u4e0d\u540c\uff0cCPU \u901a\u8fc7\u5bf9\u8fd9\u4e2a\u7535\u538b\u7684\u91c7\u6837\u6765\u786e\u5b9a\u5177\u4f53\u662f\u90a3 \u2f00\u4e2a\u6309\u952e\u6309\u4e0b\u3002\u5982\u4e0a\u56fe\uff0cVOL+\u3001VOL-\u3001MENU\u3001ENTER\u3001HOME/UBOOT \u5bf9\u5e94\u7684\u7535\u538b\u5206\u522b\u4e3a 0.21V\u30010.41V\u3001 0.59V\u30010.75V\u30010.88V\u3002\u5177\u4f53\u53ef\u4ee5\u67e5\u770b\u300a100ASK-V853_Pro\u7cfb\u7edf\u5f00\u53d1\u624b\u518c.pdf\u300b\u4e2d\u7b2c\u4e94\u7bc7\u9a71\u52a8\u5f00\u53d1\u7684\u7b2c\u2f17\u4e09\u7ae0 Linux GPADC \u5f00\u53d1\u6307\u5357\u3002"}),"\n",(0,s.jsx)(e.h2,{id:"2gpadc\u9a71\u52a8",children:"2.GPADC\u9a71\u52a8"}),"\n",(0,s.jsx)(e.p,{children:"GPADC\u9a71\u52a8\u5b58\u653e\u7684\u4f4d\u7f6e\u4e3a"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"tina-v853-open/kernel/linux-4.9/drivers/input/sensor/sunxi_gpadc.c\ntina-v853-open/kernel/linux-4.9/drivers/input/sensor/sunxi_gpadc.h\n"})}),"\n",(0,s.jsx)(e.h2,{id:"3gpadc\u5185\u6838\u914d\u7f6e",children:"3.GPADC\u5185\u6838\u914d\u7f6e"}),"\n",(0,s.jsxs)(e.p,{children:["\u5728Tina\u7684\u6839\u76ee\u5f55\u4e0b\u8f93\u5165",(0,s.jsx)(e.code,{children:"make kernel_menuconfig"})]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"book@100ask:~/workspaces/tina-v853-open$ make kernel_menuconfig\n"})}),"\n",(0,s.jsx)(e.p,{children:"\u8fdb\u5165\u5982\u4e0b\u76ee\u5f55\u4e2d\uff0c\u8f93\u5165Y\u4f7f\u80fdSUNXI GPADC\u9a71\u52a8\u3002"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"\u2192 Device Drivers \n\t\u2192 Input device support \n\t\t\u2192 Sensors\n\t\t\t <*>   SUNXI GPADC\n"})}),"\n",(0,s.jsx)(e.p,{children:"\u914d\u7f6e\u5b8c\u6210\u540e\u5982\u4e0b\u56fe\u6240\u793a\u3002"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{alt:"image-20230417174743552",src:i(4229).Z+"",width:"1590",height:"944"})}),"\n",(0,s.jsx)(e.p,{children:"\u4fdd\u5b58\u5e76\u9000\u51fa\u5185\u6838\u914d\u7f6e\u754c\u9762\u3002"}),"\n",(0,s.jsx)(e.h2,{id:"4gpadc\u8bbe\u5907\u6811\u914d\u7f6e",children:"4.GPADC\u8bbe\u5907\u6811\u914d\u7f6e"}),"\n",(0,s.jsx)(e.p,{children:"\u5185\u6838\u8bbe\u5907\u6811\u5b58\u653e\u4f4d\u7f6e\uff1a"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"tina-v853-open/device/config/chips/v853/configs/100ask/board.dts\n"})}),"\n",(0,s.jsxs)(e.p,{children:["\u8fdb\u5165\u8be5\u76ee\u5f55\u540e\u8f93\u5165",(0,s.jsx)(e.code,{children:"vi board.dts"})]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"book@100ask:~/workspaces/tina-v853-open$ cd device/config/chips/v853/configs/100ask/\nbook@100ask:~/workspaces/tina-v853-open/device/config/chips/v853/configs/100ask$ ls\nBoardConfig.mk  board.dts  buildroot  env.cfg  linux-4.9  sys_config.fex  uboot-board.dts\nbook@100ask:~/workspaces/tina-v853-open/device/config/chips/v853/configs/100ask$ vi board.dts\n"})}),"\n",(0,s.jsx)(e.p,{children:"\u627e\u5230&gpadc\u8282\u70b9\uff0c\u8fd9\u4e2a\u8282\u70b9\u4fdd\u5b58\u6709\u91c7\u6837\u76f8\u5173\u7684\u914d\u7f6e\uff0c\u952e\u503c\uff0c\u7535\u538b\u6570\u636e\u7b49\u3002"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:'&gpadc {\n    channel_num = <1>;                        // \u4f7f\u75281\u901a\u9053\n    channel_select = <0x01>;                  // \u9009\u62e9 0x01 \u901a\u9053\n    channel_data_select = <0>;                // \u542f\u7528\u6570\u636e\u901a\u9053\n    channel_compare_select = <0x01>;          // \u542f\u7528\u901a\u9053\u6bd4\u8f83\u529f\u80fd\n    channel_cld_select = <0x01>;              // \u542f\u7528\u6570\u636e\u5c0f\u4e8e\u6bd4\u8f83\u529f\u80fd\n    channel_chd_select = <0>;                 // \u542f\u7528\u6570\u636e\u5927\u4e8e\u6bd4\u8f83\u529f\u80fd\n    channel0_compare_lowdata = <1700000>;     // \u5c0f\u4e8e\u8fd9\u4e2a\u503c\u89e6\u53d1\u4e2d\u65ad\n    channel0_compare_higdata = <1200000>;     // \u5927\u4e8e\u8fd9\u4e2a\u503c\u89e6\u53d1\u4e2d\u65ad\n    channel1_compare_lowdata = <460000>;      // \u5c0f\u4e8e\u8fd9\u4e2a\u503c\u89e6\u53d1\u4e2d\u65ad\n    channel1_compare_higdata = <1200000>;     // \u5927\u4e8e\u8fd9\u4e2a\u503c\u89e6\u53d1\u4e2d\u65ad\n    key_cnt = <5>;                            // \u6309\u952e\u6570\u91cf\n    key0_vol = <210>;                         // \u6309\u952e\u7535\u538b\uff0c\u5355\u4f4dmv\n    key0_val = <115>;                         // \u6309\u4e0b\u6309\u952e\u7684\u952e\u503c\n    key1_vol = <410>;                         // \u6309\u952e\u7535\u538b\uff0c\u5355\u4f4dmv\n    key1_val = <114>;                         // \u6309\u4e0b\u6309\u952e\u7684\u952e\u503c\n    key2_vol = <590>;                         // \u6309\u952e\u7535\u538b\uff0c\u5355\u4f4dmv\n    key2_val = <139>;                         // \u6309\u4e0b\u6309\u952e\u7684\u952e\u503c\n    key3_vol = <750>;                         // \u6309\u952e\u7535\u538b\uff0c\u5355\u4f4dmv\n    key3_val = <28>;                          // \u6309\u4e0b\u6309\u952e\u7684\u952e\u503c\n    key4_vol = <880>;                         // \u6309\u952e\u7535\u538b\uff0c\u5355\u4f4dmv\n    key4_val = <102>;                         // \u6309\u4e0b\u6309\u952e\u7684\u952e\u503c\n    status = "okay";                          // \u542f\u7528GPADC\n};\n'})}),"\n",(0,s.jsx)(e.p,{children:"\u6211\u4eec\u8fd8\u80fd\u901a\u8fc7board.dts\u6587\u4ef6\u4e2d\u77e5\u9053\u8fd8\u6709\u4e00\u90e8\u5206\u4e0d\u7ecf\u5e38\u9700\u8981\u4fee\u6539\u7684\u914d\u7f6e\u4fdd\u5b58\u5728sun8iw21p1.dtsi\u6587\u4ef6\u4e2d\uff0c\u8fdb\u5165\u8be5\u76ee\u5f55\uff0c\u5e76\u6253\u5f00\u8be5\u6587\u4ef6\u3002"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"book@100ask:~/workspaces/tina-v853-open$ cd kernel/linux-4.9/arch/arm/boot/dts/\nbook@100ask:~/workspaces/tina-v853-open/kernel/linux-4.9/arch/arm/boot/dts$ vi sun8iw21p1.dtsi\n"})}),"\n",(0,s.jsx)(e.p,{children:"\u67e5\u770bgpadc\u8282\u70b9\uff0c\u53ef\u4ee5\u53d1\u73b0\u8fd9\u91cc\u7684\u914d\u7f6e\u4fdd\u5b58\u6709\u4e2d\u65ad\u548c\u65f6\u949f\u7b49\u4fe1\u606f\uff0c\u4f46\u9ed8\u8ba4\u4e0d\u4f7f\u80fd\u3002\u6ce8\u610f\uff1a\u8fd9\u91cc\u53ef\u4ee5\u4e0d\u4fee\u6539\uff0c\u56e0\u4e3a\u8fd9\u91cc\u7684\u6240\u8bbe\u7f6e\u7684status\u914d\u7f6e\u4f1a\u88abboard.dts\u4e2d\u7684status\u8986\u76d6\uff0c\u53ea\u8981\u5728board.dts\u8bbe\u7f6e\u4e3a\u4f7f\u80fd\uff0c\u6700\u7ec8\u751f\u6210\u6253\u5305\u8fdb\u955c\u50cf\u7684\u8bbe\u5907\u6811\u90fd\u4e3a\u4f7f\u80fd\u72b6\u6001\u3002"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:'gpadc:gpadc@2009000 {\n    compatible = "allwinner,sunxi-gpadc";         // \u7528\u4e8e\u9a71\u52a8\u548c\u8bbe\u5907\u7684\u7ed1\u5b9a\n    reg = <0x0 0x02009000 0x0 0x400>;             // \u8bbe\u5907\u4f7f\u7528\u7684\u5bc4\u5b58\u5668\u5730\u5740\n    interrupts = <GIC_SPI 57 IRQ_TYPE_NONE>;      // \u8bbe\u5907\u4f7f\u7528\u7684\u4e2d\u65ad\n    clocks = <&clk_gpadc>;                        // \u8bbe\u5907\u4f7f\u7528\u7684\u65f6\u949f\n    status = "disabled";                          // \u914d\u7f6e\u9ed8\u8ba4\u4e0d\u542f\u7528GPADC\n};\n'})}),"\n",(0,s.jsx)(e.h2,{id:"5\u589e\u52a0getevent\u6d4b\u8bd5\u5305",children:"5.\u589e\u52a0getevent\u6d4b\u8bd5\u5305"}),"\n",(0,s.jsxs)(e.p,{children:["\u5728Tina\u6839\u76ee\u5f55\u4e0b\u6267\u884c",(0,s.jsx)(e.code,{children:"make menuconfig"})]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"book@100ask:~/workspaces/tina-v853-open$ make menuconfig\n"})}),"\n",(0,s.jsx)(e.p,{children:"\u8fdb\u5165Utilities\u76ee\u5f55\u4e0b\uff0c\u8f93\u5165Y\u9009\u4e2dgetevent"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:" > Utilities\n \t <*> getevent.................................... getevent for Android Toolbox \n"})}),"\n",(0,s.jsx)(e.p,{children:"\u9009\u4e2d\u5b8c\u6210\u540e\u5982\u4e0b\u56fe\u6240\u793a\u3002"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{alt:"image-20230417183138871",src:i(5726).Z+"",width:"1595",height:"950"})}),"\n",(0,s.jsx)(e.p,{children:"\u4fdd\u5b58\u5e76\u9000\u51faTina\u914d\u7f6e\u754c\u9762\u3002"}),"\n",(0,s.jsx)(e.h2,{id:"6\u7f16\u8bd1\u6253\u5305\u548c\u70e7\u5199",children:"6.\u7f16\u8bd1\u3001\u6253\u5305\u548c\u70e7\u5199"}),"\n",(0,s.jsxs)(e.p,{children:["\u5728Tina\u7684\u6839\u76ee\u5f55\u4e0b\uff0c\u8f93\u5165",(0,s.jsx)(e.code,{children:"make -j32 "})]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"book@100ask:~/workspaces/tina-v853-open$ make -j32\n...\nbook@100ask:~/workspaces/tina-v853-open$ pack\n...\n"})}),"\n",(0,s.jsx)(e.p,{children:"\u200b\t\u751f\u6210\u955c\u50cf\u540e\uff0c\u5c06tina-v853-open/out/v853/100ask/openwrt/\u76ee\u5f55\u4e0b\u7684v853_linux_100ask_uart0.img\u955c\u50cf\u62f7\u8d1d\u5230Windows\u7535\u8111\u4e3b\u673a\u4e2d\uff0c\u4f7f\u7528\u5168\u5fd7PhoenixSuit\u70e7\u5199\u5de5\u5177\u70e7\u5199\u5230\u5f00\u53d1\u677f\u4e0a\u3002"}),"\n",(0,s.jsxs)(e.p,{children:["\u200b\t\u63d2\u4e0a12V\u7684\u7535\u6e90\u7ebf\uff0c\u548c\u4e24\u6761Type-C\uff0c\u628a\u5f00\u5173\u62e8\u5411\u7535\u6e90\u63a5\u53e3\u65b9\u5411\u4e0a\u7535\uff0c\u70e7\u5199\u65b0\u955c\u50cf\u540e\u7b49\u5f85\u542f\u52a8\u7cfb\u7edf\uff0c\u5728\u547d\u4ee4\u884c\u4e2d\u8f93\u5165",(0,s.jsx)(e.code,{children:"getevent"}),"\u53ef\u4ee5\u8fdb\u5165\u6d4b\u8bd5\u7a0b\u5e8f\uff0c\u901a\u8fc7\u8f93\u51fa\u7684\u6253\u5370\u4fe1\u606f\u6211\u4eec\u77e5\u9053\uff0c\u6211\u4eec\u7684gpadc\u9a71\u52a8\u4e0a\u62a5\u7684\u4fe1\u606f\u4f7f\u7528\u7684"]}),"\n",(0,s.jsxs)(e.p,{children:["\u662f",(0,s.jsx)(e.code,{children:"/dev/input/event1"}),"\uff0c\u6b64\u65f6\u6309\u4e0b\u6309\u952e\uff0c\u4f1a\u8bfb\u53d6\u6309\u952e\u7684\u952e\u503c\u3002"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:'root@TinaLinux:~# getevent\nadd device 1: /dev/input/event2\n  name:     "ft6336"\nadd device 2: /dev/input/event1\n  name:     "sunxi-gpadc0"\nadd device 3: /dev/input/event0\n  name:     "axp2101-pek"\npoll 4, returned 1\n/dev/input/event1: 0001 0073 00000001\npoll 4, returned 1\n/dev/input/event1: 0000 0000 00000000\npoll 4, returned 1\n/dev/input/event1: 0001 0073 00000000\npoll 4, returned 1\n/dev/input/event1: 0000 0000 00000000\n\n'})}),"\n",(0,s.jsx)(e.p,{children:"\u6309\u4e0bCrtl+C\u7ed3\u675f\u6d4b\u8bd5\u3002"}),"\n",(0,s.jsx)(e.h2,{id:"7\u7f16\u5199\u4e00\u4e2a\u6d4b\u8bd5\u5e94\u7528\u7a0b\u5e8f",children:"7.\u7f16\u5199\u4e00\u4e2a\u6d4b\u8bd5\u5e94\u7528\u7a0b\u5e8f"}),"\n",(0,s.jsxs)(e.p,{children:["\u901a\u8fc7\u4e0a\u4e00\u7ae0\u8282\u7684\u6d4b\u8bd5\uff0c\u6211\u4eec\u77e5\u9053gpadc\u4f7f\u7528\u7684",(0,s.jsx)(e.code,{children:"/dev/input/event1"}),"\u4e0a\u62a5\u6309\u952e\u6570\u636e\uff0c\u5219\u6211\u4eec\u7f16\u5199\u7684\u5e94\u7528\u7a0b\u5e8f\u4e2d\u83b7\u53d6\u6570\u636e\u7684\u8282\u70b9\u5e94\u8be5\u4e3a/dev/input/event1\uff0c\u5e94\u7528\u7a0b\u5e8f\u5982\u4e0b\u6240\u793a\u3002"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-c",children:'#include <stdio.h>\n#include <linux/input.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <sys/time.h>\n#include <limits.h>\n#include <unistd.h>\n#include <signal.h>\n\n#define DEV_PATH "/dev/input/event1" //Modified to gpadc drive reporting node\nstatic int gpadc_fd = 0;\n\nunsigned int test_gpadc(const char * event_file)\n{\n        int code = 0, i;\n\n        struct input_event data;\n\n        gpadc_fd = open(DEV_PATH, O_RDONLY);\n\n        if(gpadc_fd <= 0)\n        {\n                printf("open %s error!\\n", DEV_PATH);\n                return -1;\n        }\n\n        for(i = 0; i < 10; i++) //read 10 times\n        {\n                read(gpadc_fd, &data, sizeof(data));\n                if(data.value == 1)\n                {\n                        printf("key %d pressed\\n", data.code);\n                }\n                else if(data.value == 0)\n                {\n                        printf("key %d releaseed\\n", data.code);\n                }\n        }\n        close(gpadc_fd);\n        return 0;\n}\n\nint main(int argc,const char *argv[])\n{\n    int rang_low = 0, rang_high = 0;\n        return test_gpadc(DEV_PATH);\n\n'})}),"\n",(0,s.jsx)(e.h2,{id:"8\u7f16\u8bd1\u5e94\u7528\u7a0b\u5e8f\u5e76\u8fdb\u884c\u6d4b\u8bd5",children:"8.\u7f16\u8bd1\u5e94\u7528\u7a0b\u5e8f\u5e76\u8fdb\u884c\u6d4b\u8bd5"}),"\n",(0,s.jsx)(e.p,{children:"\u65b0\u5efa\u4e00\u4e2agpadc\u76ee\u5f55\uff0c\u5b58\u653e\u5e94\u7528\u7a0b\u5e8f\u548c\u53ef\u6267\u884c\u7a0b\u5e8f\u3002"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"book@100ask:~/workspaces$ mkdir gpadc_test\nbook@100ask:~/workspaces$ cd gpadc_test/\nbook@100ask:~/workspaces/gpadc_test$ vi gpadc_test.c\n"})}),"\n",(0,s.jsx)(e.p,{children:"\u5c06\u4e0a\u4e00\u5c0f\u8282\u7f16\u5199\u7684\u5e94\u7528\u7a0b\u5e8f\u590d\u5236\u5230gpadc_test.c\u4e2d\u4fdd\u5b58\u3002"}),"\n",(0,s.jsx)(e.p,{children:"\u7f16\u5199\u5b8c\u6210\u540e\uff0c\u6211\u4eec\u9700\u8981\u63d0\u4f9b\u7f16\u8bd1\u73af\u5883\u7ed9gpadc_test\u5e94\u7528\u7a0b\u5e8f\uff0c\u8f93\u5165"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"book@100ask:~/workspaces/gpadc_test$ export STAGING_DIR=~/workspaces/tina-v853-open/prebuilt/rootfsbuilt/arm/toolchainsunxi-musl-gcc-830/toolchain/arm-openwrt-linux-muslgnueabi\n"})}),"\n",(0,s.jsx)(e.p,{children:"\u4f7f\u7528\u4ea4\u53c9\u7f16\u8bd1\u5de5\u5177\u94fe\u7f16\u8bd1\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u6ce8\u610f\uff1a\u9700\u8981Tina SDK\u5305\u76ee\u5f55\u9700\u8981\u66f4\u6362\u4e3a\u81ea\u5df1\u7684\u76ee\u5f55\u3002"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"book@100ask:~/workspaces/gpadc_test$ ~/workspaces/tina-v853-open/prebuilt/rootfsbuilt/arm/toolchain-sunxi-musl-gcc-830/toolchain/bin/arm-openwrt-linux-gcc -o gpadc_test gpadc_test.c\n"})}),"\n",(0,s.jsxs)(e.p,{children:["\u7f16\u8bd1\u5b8c\u6210\u540e\u4f1a\u518d\u5f53\u524d\u76ee\u5f55\u4e0b\u751f\u6210\u4e00\u4e2agpadc_test\u53ef\u6267\u884c\u7a0b\u5e8f\uff0c\u5c06\u5176\u62f7\u8d1d\u5230\u5f00\u53d1\u677f\u4e0a\u8fd0\u884c\u5373\u53ef\u3002\u4e0b\u9762\u4f7f\u7528TF\u5361\u7684\u65b9\u5f0f\u5c06\u6587\u4ef6\u62f7\u8d1d\u5230\u5f00\u53d1\u677f\u4e0a\uff0c\u6b64\u65f6\u5047\u8bbe\u4f60\u5df2\u7ecf\u5c06\u6587\u4ef6\u62f7\u8d1d\u5230TF\u5361\u4e2d\uff0c\u63d2\u5165\u5f00\u53d1\u677f\u540e\uff0c\u5728\u547d\u4ee4\u884c\u4e2d\u8f93\u5165\u4ee5\u4e0b\u547d\u4ee4\u6302\u5728SD\u5361\u5230",(0,s.jsx)(e.code,{children:"/mnt/"}),"\u76ee\u5f55\u4e0b\uff0c\u5e76\u5c06gpadc_test\u5e94\u7528\u7a0b\u5e8f\u62f7\u8d1d\u5230\u3001root\u76ee\u5f55\u4e0b\u3002"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"root@TinaLinux:/# mount /dev/mmcblk1p1 /mnt/\n[   26.744697] FAT-fs (mmcblk1p1): Volume was not properly unmounted. Some data may be corrupt. Please run fsck.\nroot@TinaLinux:/# cd /mnt/\nroot@TinaLinux:/mnt# ls\nSystem Volume Information  gpadc_test\nroot@TinaLinux:/mnt# cp gpadc_test /root/\n"})}),"\n",(0,s.jsx)(e.p,{children:"\u8fdb\u5165/root\u76ee\u5f55\u4e0b\u6267\u884c\u6d4b\u8bd5\u7a0b\u5e8f\uff0c\u8be5\u7a0b\u5e8f\u8bfb\u53d610\u6b21\u503c\u4f1a\u81ea\u52a8\u7ed3\u675f\u624d\u6d4b\u8bd5"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"root@TinaLinux:/mnt# cd /root/\nroot@TinaLinux:~# ./gpadc_test\nkey 115 pressed\nkey 0 releaseed\nkey 115 releaseed\nkey 0 releaseed\nkey 114 pressed\nkey 0 releaseed\nkey 114 releaseed\nkey 0 releaseed\nkey 139 pressed\nkey 0 releaseed\n"})})]})}function p(n={}){const{wrapper:e}={...(0,d.a)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(l,{...n})}):l(n)}},9524:(n,e,i)=>{i.d(e,{Z:()=>s});const s=i.p+"assets/images/image-20230417172938775-0c56aed557a1b3dcdc6b9c1c4e8d5abb.png"},4229:(n,e,i)=>{i.d(e,{Z:()=>s});const s=i.p+"assets/images/image-20230417174743552-45a706f2fb97540426d4064c1ae2a0c7.png"},5726:(n,e,i)=>{i.d(e,{Z:()=>s});const s=i.p+"assets/images/image-20230417183138871-b5c429e9ef284f101a7c3e4029217c82.png"},1151:(n,e,i)=>{i.d(e,{Z:()=>a,a:()=>c});var s=i(7294);const d={},t=s.createContext(d);function c(n){const e=s.useContext(t);return s.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(d):n.components||d:c(n.components),s.createElement(t.Provider,{value:e},n.children)}}}]);