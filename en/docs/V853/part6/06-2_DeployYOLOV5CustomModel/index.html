<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-V853/part6/06-2_DeployYOLOV5CustomModel" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.1">
<title data-rh="true">部署YOLOV5自定义模型 | 全志Vision</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://vision.100ask.net/en/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://vision.100ask.net/en/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://vision.100ask.net/en/docs/V853/part6/06-2_DeployYOLOV5CustomModel"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" property="og:locale:alternate" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="部署YOLOV5自定义模型 | 全志Vision"><meta data-rh="true" name="description" content="0.前言"><meta data-rh="true" property="og:description" content="0.前言"><link data-rh="true" rel="icon" href="/en/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://vision.100ask.net/en/docs/V853/part6/06-2_DeployYOLOV5CustomModel"><link data-rh="true" rel="alternate" href="https://vision.100ask.net/docs/V853/part6/06-2_DeployYOLOV5CustomModel" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://vision.100ask.net/en/docs/V853/part6/06-2_DeployYOLOV5CustomModel" hreflang="en"><link data-rh="true" rel="alternate" href="https://vision.100ask.net/docs/V853/part6/06-2_DeployYOLOV5CustomModel" hreflang="x-default"><link rel="stylesheet" href="/en/assets/css/styles.e3ab61ce.css">
<script src="/en/assets/js/runtime~main.1a0c385c.js" defer="defer"></script>
<script src="/en/assets/js/main.15ee136a.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/en/"><div class="navbar__logo"><img src="/en/img/logo.svg" alt="东山PI" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/en/img/logo.svg" alt="东山PI" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">全志Vision</b></a><a class="navbar__item navbar__link" href="/en/docs/EmbeddedAIBasics/BoardIntroduction">嵌入式AI基础</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/en/docs/V853/BoardIntroduction">V853-AICT</a><a class="navbar__item navbar__link" href="/en/docs/V851se-TinyVision/BoardIntroduction">V851se-TinyVision</a><a class="navbar__item navbar__link" href="/en/docs/V851S/Describe">V851s-Lizard</a><a class="navbar__item navbar__link" href="/en/docs/V821/BoardIntroduction">V821-AvaotaF1</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/docs/V853/part6/06-2_DeployYOLOV5CustomModel" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh-Hans">简体中文</a></li><li><a href="/en/docs/V853/part6/06-2_DeployYOLOV5CustomModel" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li></ul></div><a href="https://github.com/100askTeam/AllwinnerVisionIC-Docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/V853/BoardIntroduction">DshanPI-AICT套件简述</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/V853/SourceCodeToolDoc">源码工具文档手册</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/V853/ConfigHostEnv">安装并配置开发环境</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/en/docs/category/开发板基础使用">开发板基础使用</a><button aria-label="Collapse sidebar category &#x27;开发板基础使用&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/V853/part1/01-1_QuickStart">开发板快速启动</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/V853/part1/01-2_UpdateTheSystem">更新系统</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/V853/part1/01-3_DevelopmentBoardDistributionNetwork">开发板配网</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/V853/part1/01-4_ADB">使用ADB进行文件传输</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/V853/part1/01-5_DevBoardFuncVerification">开发板功能测试</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/en/docs/category/sdk基础使用">SDK基础使用</a><button aria-label="Collapse sidebar category &#x27;SDK基础使用&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/V853/part2/02-1_CompileAndBuildSystem">编译构建系统</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/V853/part2/02-2_MIPIDisplayAdaptationGuide">MIPI显  示屏适配指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/V853/part2/02-3_PulleySwitchAdaptationGuide">波轮开关适配指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/V853/part2/02-4_MIPICameraAdaptationGuide">MIPI摄像头适配指南</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/en/docs/category/ai应用开发">AI应用开发</a><button aria-label="Collapse sidebar category &#x27;AI应用开发&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/V853/part3/03-1_TinaNPUDevelopmentDeploymentInstructions">Tina_NPU开发部署说明</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/V853/part3/03-2_HumanoidDAndFaceDApplications">人形检测与人脸检测应用</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/V853/part3/03-3_E907SmallCoreDevelopment">E907小核开发</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/V853/part3/03-4_ModelConversionToolInstallationGuide">模型转换工具安装</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/V853/part3/03-5_ObjectDetectionModelYolov3DGuide">目标 检测模型yolov3部署</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/V853/part3/03-6_OpenCVAndFFmpegAdaptationGuide">opencv和ffmpeg适配</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/en/docs/category/ai开发软件安装指南">AI开发软件安装指南</a><button aria-label="Collapse sidebar category &#x27;AI开发软件安装指南&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/V853/part4/04-1_AnaCondaInstallationGuide">AnaConda安装指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/V853/part4/04-2_PytorchFrameworkConstruction">Pytorch框架搭建</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/en/docs/category/算法环境搭建">算法环境搭建</a><button aria-label="Collapse sidebar category &#x27;算法环境搭建&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/V853/part5/05-1_BuildYOLOV5-V6.0Environment">搭建YOLOV5-V6.0环境</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/en/docs/category/模型部署开发">模型部署开发</a><button aria-label="Collapse sidebar category &#x27;模型部署开发&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/V853/part6/06-1_Yolov5ModelDeployment">yolov5模型部署指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/en/docs/V853/part6/06-2_DeployYOLOV5CustomModel">部署YOLOV5自定义模型</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/en/docs/category/常见问题">常见问题</a><button aria-label="Collapse sidebar category &#x27;常见问题&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/V853/part7/07-1_Question1">问题1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/V853/part7/07-2_Question2">问题2</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/V853/allwinnner">全志社区V853案例分享</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/V853/student">学员优秀案例分享</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/en/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/en/docs/category/模型部署开发"><span itemprop="name">模型部署开发</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">部署YOLOV5自定义模型</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>部署YOLOV5自定义模型</h1>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="0前言">0.前言<a href="#0前言" class="hash-link" aria-label="Direct link to 0.前言" title="Direct link to 0.前言">​</a></h2>
<p>​	本章讲述如何训练自定义数据集生成模型，部署到DongshanPI-AICT开发板上。这里假设您已经搭建好YOLOV5-V6.0的环境，搭建环境参考：<a href="https://forums.100ask.net/t/topic/3670" target="_blank" rel="noopener noreferrer">YOLOV5-V6.0环境搭建</a>。如果您没有阅读过<a href="https://forums.100ask.net/t/topic/3648" target="_blank" rel="noopener noreferrer">DongshanPI-AICT开发板支持yolov5模型部署</a>文章，请先按照这篇文章进行操作。</p>
<p>​	下面操作仅演示如何去训练自定义模型、导出模型、转换模型、模型部署。注意：训练模型对于电脑需要有一定的要求，如果电脑性能较弱可能会导致训练效果较差，从而导致模型精度较低。</p>
<p>参考链接：<a href="https://docs.ultralytics.com/yolov5/tutorials/train_custom_data/" target="_blank" rel="noopener noreferrer">https://docs.ultralytics.com/yolov5/tutorials/train_custom_data/</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1下载数据标注工具">1.下载数据标注工具<a href="#1下载数据标注工具" class="hash-link" aria-label="Direct link to 1.下载数据标注工具" title="Direct link to 1.下载数据标注工具">​</a></h2>
<p>数据标注工具：<a href="https://github.com/heartexlabs/labelImg/releases" target="_blank" rel="noopener noreferrer">https://github.com/heartexlabs/labelImg/releases</a></p>
<p><img loading="lazy" alt="image-20230628104416057" src="/en/assets/images/image-20230628104416057-57c692e8c5a5dc64a9c93fafd171cb40.png" width="1162" height="389" class="img_ev3q"></p>
<p>点击上述红框下载，下载完成后解压压缩包，双击打开<code>labelImg.exe</code>文件。</p>
<p><img loading="lazy" alt="image-20230628104508751" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAnMAAABgCAIAAAD5D2NFAAAaCklEQVR4nO3dfWwTZ54H8J9DeFtetkubOjZJ22UTdM0Wc4mrZpuIPegtviTrICRyzQLSeS3lHNETk4gup/SM0B6KD59YoXjYLSLKKbJ0tBsuvUXE62RdVFhVkE0XJ8Vto1OT7V1Lanua0m03sEt5ydwfM2PP2DO2A04cku/nDxQez/Niezy/eV5mRsfzPAEAAECW5OW6AQAAAAsKIisAAEA2IbICAABkEyLrvDA1NfXTn/50amoq1w1Z7MLhcK6bADOA72tuLLbP+cHfLyJr7k1NTTU3NxuNxpdffhnBFQDgYYfImmNCWN29e7fD4fjJT36C4AoA8LBDZM2lWFitr68noo0bNyK4AgA87BBZc8zhcAhhVSAE10gkksMmAQDAg8jPdQMWtTVr1mzdujUhcePGjTlpDAAAZAX6rAAAANmEyAoAAJBNaUeDR4/bzz9xlGko1Hg9erHllTc/ItOh7kbqdF561nWgIstNBJgHJnsPv04viT+EoUx29eGelvALHmuBIlH8vSQzHepurCRl4WIJk8ftpy9I223bj59YBoZ76k9wtqNMQyENdbLXdghfnOxoNtxTfyKkyFK8/eRObt+VTX2Ogt7DbxUfEb8OyNCEjz1jZNL+KOrP6k8e2Vo0R43KmdSRdVT8Sb/i9MpSN+xq9VgLJnzsvjc4ItOhblclEUUvtgya9jhms7EAuRL94G0ybTnH9u5gvneFbR8kGnSK0a54+8kjW4vkR+rn9/Y5yoaucFt2FKgU9fzePkeZMmmy9/Bbwl8TPmXhFGqh7U9KcXeo03lpFt7cAlTReHIXu+/Vi987ElvHMHrcfvrjXXtflDbo69503P5edXdj5XBP/ZVNfY4yGu7JVXthgdGMrELg3Lbf1Sc/B4lebHmVDloLiKjIyvRZY0eEyd5X3/yIqN0ePw0UAvBsNRxgDk1cCdFzu4vDoUvnWO8gJ3UxR4/bT9POrUUkHKkbiYiiF1vOEdHopUHuwqDslFQloKoosjKHwkl91je42XpjC1eRlemzEhF9KiaUHeh25bA9sKioR9YJH7vvHdPJ7q2fdrK9RmkoWNGRn+w93OG9RkREYjSND2eRcHJtRFiFhWH0zBsc7SIiemIH0+cgotHjdmc76W1HXaoTJRO+8x/vau2zFlCGQ8dKF06IfdYNu14gIqJQ7Jx127P3/zYWiaFOZ/ugMmkwYdRt75Z3TguHrwviBxuqH6Rtz5vmqo0LgcrnTLGxFiJZ52rCxx6j3bKO1mTv4Y5Pdi7keQ31yBo73Sty/OCS3Xl8v6v6irOd9vYdiZ10FzQccTXQqDicQqO9voLK2Cf47AevTWw/iJFhWBAmfOc/LtYLf39yjq0f5Ij0tqN7t71y2itMlCT2Rz/73TvcR/TBhHVrEU1em9A/sUP24uDp+sTjERGZDsn+I06mDve0hKVXMRqcsUqHSzr7Of3xrtY94Y72waTvyOpqEEbghJF8aTT4wpWcNfuhI33OIu0zyNEzb+j3dMs7WgUNL21veaVnqHvBTmanXcFU9uIu/b4TTkoYFhYMv3eBQhfsnO0o02CVpRdu9RzJZisBcuhTMu15LvQaEUl91gkfu++V87ajrj6anCgsKKKkpUm79treee9ToiKa/IRML8r7tSnnWQVJfVaYgd7DTu81EpaAHCCa8Om37WcOUE+9/bS4hTARfu5Neq5VsZSmorGvgogm57zJC8DktQm6QKMHKhKnPCZ85z/etftAQmrh1j3PO9s7N2UyRfIwShVZ5Z392E+d4n38yd4rtK3YVH1k06XDFyd2cvuubDpppMXQ04dFpdK6dcIXW0Ag9oT6ugsmfGz9G2SLrZwXljJFL7ace9xjLZug88d8k+vp/MfP7Z7pSsikPitGg2eg4YirQfbfT8P0xLNEhdJEuGC4p5329iUuBJHWbBZvPzkXLV1Aht/yFu09ROd7o2WK+ZHoxWPvmA4eUZkZrHTs3WY/fXyBXk6iHlmFmLqhWL9h1+7EVUjSr33C9/rbxh9smXiPqOzAETpu5w51l5HvPFFBw5G9x+1sb4prdQAeVmUHul0Uvdhif5N2tfZ1U+9htvclJn4oL9zqcRARFVl/8KS9Yx/pbUdnsOBAPJ2Vrw0Om8SYjdHgzEh9VpnEedZWj7UxPghX0XgyzB4fLjtQUXag25XYu4L0Ro+f4GxHGyvps9fOjTbIuqFD50JbXmI0zizLXtyl33f24oGKxPvQLQDqkVUYQJ/wsce0c34a1u9xFFx7h4gmew+fpv2uSqIJ8cWyA/vfq3/1YsORBfiRwaJV6WAqhbV7tP1kt6touKfeHtq233WgkCgqbZRwxV6x6XszOb+sdLj6HJO9h98qfkn/2ivcHuGaEHp8wV//l0WKPutwT/1ZbsM1/Z6kKb2kBTiy1TfSqQxkYPS4/TTtF5bybT1oZOs7KTbGW+lgUsykxhb0LDxp5lk/eqOj/o3ERGHup9LRSDR5jUhYzZS4UUWjyrwswEOvoOGIq2G4p97upOf3KgYYr725z/6mcFAmH1svXLRGPfV21iYfv0mzgkm8JUVlIVXu76nvvGib4GwvNSZngDSEK4yLt5880lgkruVWXL8gX4CT0V0OINlwT/2JkPzuJUVW5lCns96u+KgXoTSRVeWa1PjcDyWkC1fKb9uPi21g4RL284SYSkRh7qPYPKvdSbta+8TFkI193ZO9h531RdLCpZQrmIY6Oz7Z6ToghOGKxj7qaTHu9hRS/MYsWHKfjjgaXLz9ZLdL6ncKw7xCfCUqNm2j0IWEEWPlFSNUvL0PQ24pDXU62yfkH7Ko0uHq23Gxxe5sj+/qo7H7iG3Y1boYBgN0PM/nug0A80U4HDYajbluBWQK39fcWGyf84O/X9yRHwAAIJsQWQEAALIJkRUAACCbEFkBAACyCZEVAAAgmxBZAQAAsgmRFQAAIJtwPSsAAEA2oc8KAACQTYisAAAA2YTICgAAkE2IrAAAANmEyAoAAJBNiKwAAADZhMgKAACQTWmefD4V2sHzPPHEExFP4sWv0h88T0tWPPXNTb+Y/XYCAAA8HNJEVp7n165vJOKJponniaaJeOLj/17/uG9uGgoAAPBQSDcaLPRVNcIq0TThDk4AAAAyaSIrT5QyrE5nFFj7m3XVnvEHbywAwMxwATfjDWm8GPK6A5z8v9qbEhdwa78IoJBmNJh4ShFWhRnXOWknQE6FvExXkIiIjFZnm0WfkCpPFNMj8iQu4Hb5wkREZG5ibSZZyVzA7YrUiWlJGdXrTcgY2yix7HSFJFWXOkuKxsxfektbk5dxB1Tf5UikokZPRCGvO1rTZslB82BhSj/Pmiqs0nQ2Auu4p7p09BB/qvbBiwKYDSGv3+BkWeEYzLi8hazNRFzA3RWxOlmLXpno8oXNZrMyu8tnaGLbTEJw8pbL4h93dZisds2MKvUmZxwpZ1mbStmpG59cXeosqRozrwTcjHgWI+difLG/hRMDLuCPVNj1FI+wnDJL/EwihpH/X+NEBiBtn5UoRVhFhxUWB5OtTTqCmsrN5I9yZKKrw2FzXZueiMhUYzW6RkI2k0lvaWMtRCFvMKIowVxuUmaXer0DPqpw6olILaNavSoZbeqbpCpEq50psqRozPwivDUu4B4obFNEPrFnKjaauzocNtQJgTUYDgbFyBtk4qMQNtZZw+n1QgZFgRwXSwdIlsEKplRhNUVw7W/WSeo648njnmopublf2Ky09TJ11unEudjEDQDmk9BIkAyFeiIuEpbCJZG+0ECRKKeRx1RjjfiF+bzQSNBcFx+WDI0EjRWbMzlCx+rVzpi+sIRCEnABN6OYdtTMkrqc+UG/uSIyopgXDY1EZB9PaEDs2HIBf8TqZFmWZZvMZG5iWZZlWSkAX+1mGCZxMpZhugc4rW8bILPRYM2wyk/f4Xni797Q5a9W5utv1tWRn+drpf+8L6SPe46Rl+dLxNTmnfypU/xYWXw0WGUDDBLDfMEF3F1BcxNrIuKiEaLyzLOGfeJwpNFaE0sMjQTNdWz6CCWrVyWjNIlrFgacMy4kPdUs91FOTug3V0S6A5zJInU5pbFf6X9ms5GIuKvDBnHoQa0QoQNMFB8qNtlY1jaL7YaFIIPRYK3eKvFfRa8uyV/x1f/86yPPHFNk6T/bWdUxJoXE2p0OEiNrScuplnFPta71MhEROZIqS7sBQG5wAbfLR8K8Kom91ExzdsczyqYouYA/aK5Ld5BOqFdIUmSUjv4hL8P41ZcWqRSSTBZFtLJkVM58obfYK9zdgc1tFj2FvK7hCmc8gHJUYa+h7gEifWw0PZHKNKtynvVhWsgFcyttn5W0wirx07dv/fHR4qrr1y5nWtu4p7q0lTrGeL5EWLc04w0AciHkZbqoiU3op0ViU41cNEKGcvVjLCebkJVPUQrpqXt+qvVqZTTZmsyM/ypnSTjYqzd+5vXeRzk5pre01XkZhkmOgSaLhbgAUXL8FOdZyWh1tsk7pyGve4Qqym2Wh+ftQ+6knWfVDKtEPM/zS/KX88lTrbU7HZdbj4mzpOOedmmedWz0clWHt6WEiMZ/fUYlIKfdAGDucQF/0NyUsAzUVGMl34AwkRca8JG1RuOQq99cYQz6pZm6+Dzt1WHZRG3m9SZklF1lyQX8KhOt6oWoVyfOs6pmybyc+Sgc0ZwEt7ExsnlWVhGIQ17Gb7DbbIUjKS54BYhJ12cl0gqrxE+L65tU1jDVnvI7dHW6TiKiqo4OB50Rkg92tJeW6lqJqMrhqBI3Lvnhi1WtdbrOqo6xS6obAOQUFwlTsEs2EGhuYm0mvcVudbsYRkzQHhXUW9qaIox01Yd4qYZ00cyM69UrM+otdoObYbqk15Oaod74mddLMy8np8S+qLlJ6HiGvAzTdT/DtyEv0xWUprD1Npa8DNM1z9875JxOpccpc32o7tEna7RuwxT96LeFG/4m+tFvC7f8Zs5aDLAAhLyM33A/k3T3nXHxEK5nVQ1+4mIv6XrWxOtyQl5mJH5BsBCbVcuJh20EWFCTJrJ+PlT32JMWrdswRf/wduF3tkT/8Hbh9xFZATKHwAqwkKWLrL+rFV/npSfIyR8qR7yOdLr8Vfqq/56DtgIAAMx/8cj6RXFpbpuyMKy7NpbrJgAAQC6lWxsMAAAAM5G4NhhdrvuGTj8AABD6rAAAANmFyAoAAJBNqe4U8eWH/8VPnNQtuz294tvLn3x5VcFf//nW7cjkHyNRLiKKfvUNwz/96IfffeKxOWsxAADAfKYZWT/8ZHL1B/9uKF1D64rozs1fev/xpZ9xX16fpLu35Jutq24s/W4FIisAAIBAczT4PwLvfn3vLi1bTvnLaOnyO3empv90Le/erYTNpm9cv37z61luJADA/Qp5cbNfmGOafdZHVi0nItLp/jz1l+k7d3f/qGxvw3e+4L46durDY/85Gdvs3tT1L24kR9b+Zt1Z7UerjnviD2RNK3VRAAApmcrNXf5AjSnhxlXSY21Vye5bKD45r6liuEu5udq9DXGPLCCiFJF13eoV9DUR0fS96dXr1hDxNL3y7//h9z//5yJ5ZL07df2PNxI7srOkv1nXXjZ2qaVkbqoDiIs/a0x+U/dYasKd3kNepisiT5IdxROPx1zA7YrUiWlJGdXrTcgY20jjPraahSRVlzpLisbMMypRU3oiAslaH38binsIcwH3gKwQcxPLmogLDMs/3pCXGYn9lfAYV1lV8/+jmj3Je1e6HTXTH06achS3fxZKMDexNpPim5rl70Uzsn5rjRhZRTzRvTvtrRuKHr2tI/qrp5/+6quvwuHw7akvvsRoMCxwIa/f4GRZ5ZPLuYC7KyI8BFyR6PKFzWazMrvLZxCelhLyMl3ectnhQHrmjUZGlXqTM46Us6xNpezUjU+uLnWWVI2Zhx78bvl6SxtriUfQWa1rYVHdu1LvqJn/cNLu8BolEJEsns72LqwZWR9ds5ImeeJJp9MREfHT7w1P7Gwa4ol4osnJyRMnTrAsOzg4+OWfbk5P83l5ullqIkCumWyxn2bsyeUke6C5qcZqdI2EbCaT3tLGWohC3mBEUYL0QNX4g8+F9NCAjyqceiJSy6hWr0pGm/omqQrRameKLCkaM8+FvO5oTeyAKnuaTdin6F4qHpEn6y4FmaDR2lShfIgekblcUUdiz5Vo0XZYVfcufcodNfMfTupy5KQesFr01BuMpLbrZ4vmCqZH16ycnuZp+u6qb64kIpq+d/fW19dv0Bc3iIg+//zzoaGhp556ioj4r6c+//KGZg3jnmqdqLlf/kJ/s0p6PLHaM67d7P5mXbWnXyy5uT+eT5YrVlS1x9OsVlxiXeOe6lhb+psVf2bQJFgc4k8uj8ieP64vNFAkqvlw7RprRHz0eWgkaK6TDY+NqDyrPHW92hnTF5ZQSILYk8/TZkldznwRW7mkN9DwVY6IiItG5E+bN1qd4nPOnVZj7JnnrNNqJOFYzzaZiYjMTW0Wk6WNVVL0d0w2lmWdTqeshEUaVtPLeK/X/uGkL0ccUtL4Brirw2H5npB1mn3Wxx5Z9fvPCzdMfUkrVlH+Mrr9l8tX4tOrRqPx7t27r7/+OhHp7t767Mubj69bo1bMuOcYeXm+hIj6m3V1zbG1SJ11Z/08f0qRLkykCluPe6pLmzemWLl0ubX9xTGeL+lv1tXpOh1+nj9F457q0mP9LUJRdeTn+VqxKKIOZXa1ulou+Ud17Z6DtRuP1b3fMXapVn0zLKZatLiAuytobmJNRFw0QlSePosk1j0yWmtiiaGRoLmOTX+IkdWrklE2H6h6eq5VSHqqWe6jnNwwlZu7hIGEQkN4hCPSc1eHDeVt8S3Snh2EohEjmSsMI4HAiM+X2CeVQqfRIBTDcQPdrmCYxJCNoJogwx1VSeWHk0E5wS4XGa3OpLAaH6UwWp2zuQdrRlb9urU/+8Dy4btH/+77f8r7xpq33p3+2a9WG75btWLNuhVr161Yuy5489GtLb9YtvaxJSvXfqG5iKmk5VTLuKda13qZiIgcsRccfilC1R7sqCo923+qls520mUq1bVK21R9OE6aYayqw9tSQkS1Ox30ftnBWiKiko3P0JkPx6l27GxnVcdYrdSGQ47WdmXuftW6SmpP+c/qSnVU1TF2qkR7M602wQImLhF1ssKvVV9oyHQ0iQt0xzPK5ne4gD9orrPNrF4hSZFRHEijkJdh/Opn6SqFJJPKSZElo3LmAS5Chs2y0GowRqIc6RMCa+LwrnI0mIhCUaowUKTQUj7iJZa1EREXcHeTPeEzjgy4maB8wZRsmBlzsDEZ7KgKWj+cDMoxN7HlI4zLTQmvxscRQl6G8c7ed6MZWZfmL8lb8ciZe/9yLrh67fK8R5bTD3+cv2bFkrUrlq5duXTtyqW3vr79m09XTOt0PE1rRtZxT3VpK3WM8XyJcK1NmuZUdSSt/Z21JwSo1PUAm8GCFvIyXdTEJvTTIrE5Hi4aIUO5+oGCk03IyueGhPTUP2zVerUymmxNZsZ/lbMkDpqpNn7m9d5HOTnCRYWTnlhoLTSERziOFIGVi4TjUU99bfAIbS4nX4TIZLOFvEws8gphUzhKc9GIobzNZoud6MimckNeZmQ2hxwfUlo7agKtH06G5ZhsTqvbpblMaZbXCqS6b/C6tSt1Kx+Zzl/2whO6F8sf27H5ccszhVueLjSX6Mue0j/9RAF/704ez+toWvPCm7HRy1LfcvzXZy7LXuk8K06ujntsrZcdO2uJanc6Lrcek+Zc+5uV07Izoihq3NPeSdKf1cJsqUZd/c1173eMjXVQq80znljOgzUJHl5cwB80NyX8Pk01VvINCHcgCA34yFqjcQjVb64wBv3S/GV8njb9TI9qvQkZuYBbug0CF/CrzDupF6JenTjPqpol83Jyj4uQ8DmInVUy2Vib/uqwQfZ5J0y5qpVChs3yw7g0gyrNzgqdHy5CBo1TqoA/orlXLDppd9Qk6j+cGZSjt7Q1mYNd6vcJmeW1AqnuG/yt1Sv+9/qfiejWdN6yZcuWLl26dOnS/Px84Y/ly5fr7kxQ3po8yvtiSiOy1h7saC8VBlOrHI4q2SsOOqvT1Ql/+sW5y9pTYx3VpcJaZHL4+VP3/77kRVV1dDjoTIoNxLr6m3V173eMnSopIW/HmVJhTjV7TYKHFhcJKwcOzU2szaS32K1uF8OICdrn33pLW1OEkYYHxX6SdNHMjOvVKzPqLXaDm2G6pNeTmqHe+JnXSzMvJ0e4gD9oEAbL9ZY2qZOaMMcaGvCRwZmyHJPFQpTm5k1cwB+psKt/9bLKQX1HVVzMrZJF5YdD6XZ4BZONbSKmi4lYnW0WmsNheh3P88JfwuNF5c9nPdA54H/3/5YtWVL37fwXnlkvD6v5+fn5+fn/9qt3b9Aq0uk2rf9m+4+3zlojH9ic3GMi+QME0HLf9+rBTX7SCrjdZG/bfFX7FkvmpibqGlFcVhxwDxS21UTFPIrpuJFyNvaCktFsJiqXDSIn5obUlBdBLSSpIuvRX/62860Plufn/e2TSxue2yAPq/fu3bt58+bAe1zeqnWPrvlG1dPrn3u6ODfvQN24p/rYxktCV1jsi872bCkiK2QMgRVAObu9sKSKrNxnn7Wd+OXtafr2Wt13Hl/N8/ydO3fy8vJWr15tNBrXr1+/evXqVatWrVq1Ki9v/j3nddxTXSquSJ6bRUiIrAAAQKkjK8wIPkAAAKDUa4MBAABgphBZAQAAsgmRFQAAIJsQWQEAALIJkRUAACCbEu/BJCxwBQAAgPuDPisAAEA2xa9nBQAAgAeHPisAAEA2IbICAABkEyIrAABANiGyAgAAZBMiKwAAQDYhsgIAAGQTIisAAEA2IbICAABkEyIrAABANiGyAgAAZBMiKwAAQDb9PxY+KLeytPOUAAAAAElFTkSuQmCC" width="627" height="96" class="img_ev3q"></p>
<p>打开后等待运行，运行完成后会进入如下标注工作界面。</p>
<p><img loading="lazy" alt="image-20230628104644114" src="/en/assets/images/image-20230628104644114-c747c2061df4c44f826b2024ba4ef5d5.png" width="1917" height="1045" class="img_ev3q"></p>
<p>关于LabelImg更多的使用方法，请访问：<a href="https://github.com/heartexlabs/labelImg" target="_blank" rel="noopener noreferrer">https://github.com/heartexlabs/labelImg</a></p>
<p>由于LabelImg会预先提供一些类供您使用，需要手动删除这些类，使得您可以标注自己的数据集。步骤如下所示：</p>
<p><img loading="lazy" alt="delete-labelImg-predefind" src="/en/assets/images/delete-labelImg-predefind-76f8b3a809df1c91ea8fef30c7c4cc12.gif" width="1426" height="770" class="img_ev3q"></p>
<p>进入LabelImg程序目录中的data目录中，打开<code>predefined_classes.txt</code>文件，删除文件中所有预定义的类后保存并退出即可。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2创建数据集目录">2.创建数据集目录<a href="#2创建数据集目录" class="hash-link" aria-label="Direct link to 2.创建数据集目录" title="Direct link to 2.创建数据集目录">​</a></h2>
<p>在任意工作目录中创建<code>images</code>文件夹和<code>labels</code>文件夹分别存放图像数据集和标注信息。这里我演示仅使用少量图像样本进行标注，在实际项目中需要采集足够的图像进行标注才拿满足模型的准确率和精度。</p>
<p>例如我在<code>100ask-yolov5-image</code>目录中创建有<code>images</code>文件夹和<code>labels</code>文件夹，如下所示，创建images文件，存放图像数据集，创建labels文件夹，该文件夹用于后续存放标注数据。</p>
<p><img loading="lazy" alt="DataSetworkingDirectory" src="/en/assets/images/DataSetworkingDirectory-79ae36eb447b9cd4c19921b4813e2e23.gif" width="752" height="604" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3标注图像">3.标注图像<a href="#3标注图像" class="hash-link" aria-label="Direct link to 3.标注图像" title="Direct link to 3.标注图像">​</a></h2>
<p>打开LabelImg软件后，使用软件打开数据集图像文件夹，如下所示：</p>
<p><img loading="lazy" alt="LabelImg-OpenDataSetDirectory" src="/en/assets/images/LabelImg-OpenDataSetDirectory-f65464580afa64ea96d6254c8942cfed.gif" width="954" height="555" class="img_ev3q"></p>
<p>打开后，修改输出label的文件夹为我们创建的数据集目录下的<code>labels</code>文件夹</p>
<p><img loading="lazy" alt="LabelImg-changelabelDir" src="/en/assets/images/LabelImg-changelabelDir-813fefed2432c8e33302a8f58d1f621a.gif" width="954" height="555" class="img_ev3q"></p>
<p>标注完成后后会在<code>labels</code>目录下生成<code>classes.txt</code>（类别）和图像中标注的类别即位置信息。</p>
<p>下面为LabelImg<a href="https://github.com/heartexlabs/labelImg" target="_blank" rel="noopener noreferrer">快捷键目录</a>：</p>
<table><thead><tr><th>Ctrl + u</th><th>Load all of the images from a directory</th></tr></thead><tbody><tr><td>Ctrl + r</td><td>Change the default annotation target dir</td></tr><tr><td>Ctrl + s</td><td>Save</td></tr><tr><td>Ctrl + d</td><td>Copy the current label and rect box</td></tr><tr><td>Ctrl + Shift + d</td><td>Delete the current image</td></tr><tr><td>Space</td><td>Flag the current image as verified</td></tr><tr><td>w</td><td>Create a rect box</td></tr><tr><td>d</td><td>Next image</td></tr><tr><td>a</td><td>Previous image</td></tr><tr><td>del</td><td>Delete the selected rect box</td></tr><tr><td>Ctrl++</td><td>Zoom in</td></tr></tbody></table>
<p>经过标注大量的图像后，<code>labels</code>文件夹如下图所示</p>
<p><img loading="lazy" alt="LabelImg-LabelsDir" src="/en/assets/images/LabelImg-LabelsDir-977ae89dcaf72ec3d958a0caebb217a6.gif" width="1240" height="771" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="4划分训练集和验证集">4.划分训练集和验证集<a href="#4划分训练集和验证集" class="hash-link" aria-label="Direct link to 4.划分训练集和验证集" title="Direct link to 4.划分训练集和验证集">​</a></h2>
<p>在模型训练中，需要有训练集和验证集。可以简单理解为网络使用训练集去训练，训练出来的网络使用验证集验证。在总数据集中训练集通常应占80%，验证集应占20%。所以将我们标注的数据集按比例进行分配。</p>
<p>​	在yolov5-6.0项目目录下创建100ask文件夹（该文件夹名可自定义），在100ask文件夹中创建train文件夹（存放训练集）和创建val文件夹（存放验证集）</p>
<p><img loading="lazy" alt="100ask-trainVal-Img" src="/en/assets/images/100ask-trainVal-Img-339edacbbe025f8d647fc22b2c8e1a19.gif" width="693" height="601" class="img_ev3q"></p>
<p>​	在train文件夹中创建images文件夹和labels文件夹。其中images文件夹存放总数据集的80%的图像文件，labels文件夹存放与images中的文件对应的标注文件。</p>
<p><img loading="lazy" alt="100ask-trainDir-ImgLab" src="/en/assets/images/100ask-trainDir-ImgLab-8f4aeee703456f5f09fba534a95cddee.gif" width="693" height="684" class="img_ev3q"></p>
<p>​	在val文件夹中创建images文件夹和labels文件夹。其中images文件夹存放总数据集的20%的图像文件，labels文件夹存放与images中的文件对应的标注文件。</p>
<p><img loading="lazy" alt="100ask-trainVal-Img" src="/en/assets/images/100ask-trainVal-Img-339edacbbe025f8d647fc22b2c8e1a19.gif" width="693" height="601" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="5创建数据集配置文件">5.创建数据集配置文件<a href="#5创建数据集配置文件" class="hash-link" aria-label="Direct link to 5.创建数据集配置文件" title="Direct link to 5.创建数据集配置文件">​</a></h2>
<p>进入yolov5-6.0\data目录下，创建<code>data.yaml</code>，文件内容如下所示：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">train: 100ask\train\images  # train images </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">val: 100ask\val\images  # val images</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nc: 3  # number of classes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">names: [&#x27;T113&#x27;, &#x27;K510&#x27;, &#x27;V853&#x27;]  # class names</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" alt="100ask-dataYaml-Config" src="/en/assets/images/100ask-dataYaml-Config-8a28809db12b4f37671a212d00ecb8a4.gif" width="1041" height="646" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="6创建模型配置文件">6.创建模型配置文件<a href="#6创建模型配置文件" class="hash-link" aria-label="Direct link to 6.创建模型配置文件" title="Direct link to 6.创建模型配置文 件">​</a></h2>
<p>进入models目录下，拷贝yolov5s.yaml文件，粘贴并models目录下重命名为100ask_my-model.yaml，例如：</p>
<p><img loading="lazy" alt="100ask-modelYaml-Config" src="/en/assets/images/100ask-modelYaml-Config-ed7a4d9dde7d101d34d27ac99ff85986.gif" width="1041" height="646" class="img_ev3q"></p>
<p>修改100ask_my-model.yaml中类的数目为自己训练模型的类数目。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="6修改训练函数">6.修改训练函数<a href="#6修改训练函数" class="hash-link" aria-label="Direct link to 6.修改训练函数" title="Direct link to 6.修改训练函数">​</a></h2>
<p>打开yolov5-6.0项目文件夹中的train.py，修改数据配置文件路径，如下图红框所示：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">parser.add_argument(&#x27;--cfg&#x27;, type=str, default=&#x27;models/100ask_my-model.yaml&#x27;, help=&#x27;model.yaml path&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">parser.add_argument(&#x27;--data&#x27;, type=str, default=ROOT / &#x27;data/data.yaml&#x27;, help=&#x27;dataset.yaml path&#x27;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="7训练模型">7.训练模型<a href="#7训练模型" class="hash-link" aria-label="Direct link to 7.训练模型" title="Direct link to 7.训练模型">​</a></h2>
<p>在conda终端的激活yolov5环境，激活后进入yolov5-6.0项目文件夹。执行<code>python train.py</code>，如下图所示：</p>
<p><img loading="lazy" alt="image-20230628174332495" src="/en/assets/images/image-20230628174332495-3a9ae4f362496cb3056db2edba02e565.png" width="1904" height="997" class="img_ev3q"></p>
<p>程序默认迭代300次，等待训练完成...</p>
<p><img loading="lazy" alt="image-20230628182753106" src="/en/assets/images/image-20230628182753106-e56935d70172f9d1ce60a18a04e3f783.png" width="1895" height="499" class="img_ev3q"></p>
<p>训练完成后结果会保存在<code>runs\train\</code>目录下最新一次的训练结果，如上图所示，此次训练的最好模型和最后训练的模型保存在以下目录中</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">runs\train\exp7\weights</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="8验证模型">8.验证模型<a href="#8验证模型" class="hash-link" aria-label="Direct link to 8.验证模型" title="Direct link to 8.验证模型">​</a></h2>
<p>修改val.py函数，修改如下</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    parser.add_argument(&#x27;--data&#x27;, type=str, default=ROOT / &#x27;data/data.yaml&#x27;, help=&#x27;dataset.yaml path&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    parser.add_argument(&#x27;--weights&#x27;, nargs=&#x27;+&#x27;, type=str, default=ROOT / &#x27;runs/train/exp7/weights/best.pt&#x27;, help=&#x27;model.pt path(s)&#x27;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" alt="image-20230628183910971" src="/en/assets/images/image-20230628183910971-bf137aa952d3e8fff801333cba0e04d9.png" width="1079" height="250" class="img_ev3q"></p>
<p>修改models文件夹下的yolo.py</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">class Model(nn.Module):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    def __init__(self, cfg=&#x27;100ask_my-model.yaml&#x27;, ch=3, nc=None, anchors=None):  # model, input channels, number of classes</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" alt="image-20230628185921751" src="/en/assets/images/image-20230628185921751-f653931bbac9f2cc57834ea4a530b51b.png" width="1000" height="377" class="img_ev3q"></p>
<p>打开conda终端输入<code>python val.py</code></p>
<p><img loading="lazy" alt="image-20230628190017879" src="/en/assets/images/image-20230628190017879-b1deaf0d18fcb81eb7832bd50f0f00f4.png" width="1901" height="301" class="img_ev3q"></p>
<p>执行完成后的结果保存在<code>runs\val\exp</code>文件下。</p>
<p><img loading="lazy" alt="100ask-valRun" src="/en/assets/images/100ask-valRun-26a1d32794ec2b233360e7f724c43289.gif" width="1338" height="853" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="9预测图像">9.预测图像<a href="#9预测图像" class="hash-link" aria-label="Direct link to 9.预测图像" title="Direct link to 9.预测图像">​</a></h2>
<p>在data目录中新建<code>100ask-images</code>文件夹存放待检测的图像和视频文件。</p>
<p>修改detect.py函数中，模型的路径与检测图像路径。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">parser.add_argument(&#x27;--weights&#x27;, nargs=&#x27;+&#x27;, type=str, default=ROOT / &#x27;runs/train/exp7/weights/best.pt&#x27;, help=&#x27;model path(s)&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">parser.add_argument(&#x27;--source&#x27;, type=str, default=ROOT / &#x27;data/100ask-images&#x27;, help=&#x27;file/dir/URL/glob, 0 for webcam&#x27;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" alt="image-20230629103359183" src="/en/assets/images/image-20230629103359183-3e14ee287050fc433cc06920abe85c37.png" width="1254" height="219" class="img_ev3q"></p>
<p>检测效果如下图所示：</p>
<p><img loading="lazy" alt="2023-06-28 191541(3)" src="/en/assets/images/yolov5-detect-fdbb29f38278d8267cfad9836c6a200c.jpg" width="3024" height="4032" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="10导出onnx  模型">10.导出ONNX模型<a href="#10导出onnx模型" class="hash-link" aria-label="Direct link to 10.导出ONNX模型" title="Direct link to 10.导出ONNX模型">​</a></h2>
<p>修改export.py函数</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">parser.add_argument(&#x27;--data&#x27;, type=str, default=ROOT / &#x27;data/data.yaml&#x27;, help=&#x27;dataset.yaml path&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">parser.add_argument(&#x27;--weights&#x27;, type=str, default=ROOT / &#x27;runs/train/exp7/weights/best.pt&#x27;, help=&#x27;weights path&#x27;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" alt="image-20230629103642324" src="/en/assets/images/image-20230629103642324-e96dafcfeb35aebbf4737009c19fda4d.png" width="1134" height="196" class="img_ev3q"></p>
<p>在conda终端输入：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python export.py --include onnx --dynamic</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" alt="image-20230629104014942" src="/en/assets/images/image-20230629104014942-21b7682f6ae4ca66507e9bf44b7c1742.png" width="1900" height="466" class="img_ev3q"></p>
<p>导出的模型会与输入的模型位于同一路径下，假设我输入的模型位于：<code>runs\train\exp7\weights</code></p>
<p><img loading="lazy" alt="image-20230629104123779" src="/en/assets/images/image-20230629104123779-1acbf1ae8cd865a86246e73a250e9a55.png" width="618" height="142" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="11简化模型">11.简化模型<a href="#11简化模型" class="hash-link" aria-label="Direct link to 11.简化模型" title="Direct link to 11.简化模型">​</a></h2>
<p>简化模型前需要用到<code>onnxruntime</code>依赖包，输入以下命令安装：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pip install onnxruntime==1.13.1 -i https://pypi.doubanio.com/simple/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>简化命令如下：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python -m onnxsim &lt;输入模型&gt; &lt;输出模型&gt; --input-shape &lt;输入图像尺寸&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>例如：</p>
<p>输入模型路径为runs/train/exp7/weights/best.onnx，输出模型路径为runs/train/exp7/weights/best-sim.onnx</p>
<p>输入图像尺寸固定为640x640。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python -m onnxsim runs/train/exp7/weights/best.onnx runs/train/exp7/weights/best-sim.onnx --input-shape 1,3,640,640</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" alt="image-20230629110454569" src="/en/assets/images/image-20230629110454569-8e9d916f264d176ccf580fe6e8b738bf.png" width="1787" height="509" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="13查看模型">13.查看模型<a href="#13查看模型" class="hash-link" aria-label="Direct link to 13.查看模型" title="Direct link to 13.查看模型">​</a></h2>
<p>访问：<a href="https://netron.app/" target="_blank" rel="noopener noreferrer">https://netron.app/</a></p>
<p><img loading="lazy" alt="image-20230629111343751" src="/en/assets/images/image-20230629111343751-ba803b8f817951c98390a21161da7f19.png" width="1456" height="898" class="img_ev3q"></p>
<p>可以看到输入已经固定为640x640，可看到模型有 4 个输出节点，其中 ouput 节点为后处理解析后的节点；在实际测试的过程中，发现 NPU 量化操作后对后处理的运算非常不友好，输出数据偏差较大，所以我们可以将后处理部分放在 CPU 运行；因此在导入模型时保留 <code>350</code>，<code>498</code>， <code>646</code> 三个后处理解析前的输出节点即可。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="14验证模型">14.验证模型<a href="#14验证模型" class="hash-link" aria-label="Direct link to 14.验证模型" title="Direct link to 14.验证模型">​</a></h2>
<p>模型需要修改为简化后的模型路径。</p>
<p>新建文件夹存放固定的输入图像尺寸。假设上述中我设置输入图像尺寸为640x640，那么此时我在data目录下新建100ask-images-640文件夹存放640x640的图像作为待测数据。</p>
<p>修改detect.py函数</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    parser.add_argument(&#x27;--weights&#x27;, nargs=&#x27;+&#x27;, type=str, default=ROOT / &#x27;runs/train/exp7/weights/best-sim.onnx&#x27;, help=&#x27;model path(s)&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    parser.add_argument(&#x27;--source&#x27;, type=str, default=ROOT / &#x27;data/100ask-images-640&#x27;, help=&#x27;file/dir/URL/glob, 0 for webcam&#x27;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" alt="image-20230629112042899" src="/en/assets/images/image-20230629112042899-d3a5034ecc092b85f4941fc0e873bf00.png" width="1135" height="133" class="img_ev3q"></p>
<p>在conda终端输入：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python detect.py</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" alt="image-20230629112859954" src="/en/assets/images/image-20230629112859954-188795f230e3b5dc1e5f546ef41732a7.png" width="1903" height="180" class="img_ev3q"></p>
<p>通过输出信息可知：检测结果存储在runs\detect\exp6</p>
<p>检测结果如下：</p>
<p><img loading="lazy" alt="test-640" src="/en/assets/images/test-640-f1a4d3f35c69ddac5f4fb38b5f5a5686.jpg" width="640" height="640" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="15转换模型">15.转换模型<a href="#15转换模型" class="hash-link" aria-label="Direct link to 15.转换模型" title="Direct link to 15.转换模型">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="151-创建工作目录">15.1 创建工作目录<a href="#151-创建工作目录" class="hash-link" aria-label="Direct link to 15.1 创建工作目录" title="Direct link to 15.1 创建工作目录">​</a></h3>
<p>将简化后的<code>best-sim.onnx</code>模型传入配置到NPU模型转换工具的虚拟机中，创建模型工具目录，包含模型文件，量化文件夹<code>data</code>（存放量化图片），<code>dataset.txt</code>文件(存放量化图片的路径)。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">buntu@ubuntu2004:~/100ask-yolov5-test$ tree</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── best-sim.onnx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   └── test01.jpg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└── dataset.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1 directory, 5 files</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>工作目录如下所示：</p>
<p><img loading="lazy" alt="100ask-changeModelDir" src="/en/assets/images/100ask-changeModelDir-1743615989f17600eeb424cd0b391c70.gif" width="945" height="479" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="152-导入模型">15.2 导入模型<a href="#152-导入模型" class="hash-link" aria-label="Direct link to 15.2 导入模型" title="Direct link to 15.2 导入模型">​</a></h3>
<p>导入模型前需要知道我们要保留的输出节点，由之前查看到我们输出的三个后处理节点为：<code>350</code>，<code>498</code>，<code>646</code> 。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pegasus import onnx --model best-sim.onnx --output-data best-sim.data --output-model best-sim.json --outputs &quot;350 498 646&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>导入生成两个文件，分别是是 <code>yolov5s-sim.data</code> 和 <code>yolov5s-sim.json</code> 文件，两个文件是 YOLO V5 网络对应的芯原内部格式表示文件，<code>data</code> 文件储存权重，<code>cfg</code> 文件储存模型。</p>
<p><img loading="lazy" alt="100ask-leadingInmodel" src="/en/assets/images/100ask-leadingInmodel-a1dfa98490b8f773a21875a5411e364b.gif" width="967" height="626" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="153-生成-yml-文件">15.3 生成 YML 文件<a href="#153-生成-yml-文件" class="hash-link" aria-label="Direct link to 15.3 生成 YML 文件" title="Direct link to 15.3 生成 YML 文件">​</a></h3>
<p>YML 文件对网络的输入和输出的超参数进行描述以及配置，这些参数包括，输入输出 tensor 的形状，归一化系数 (均值，零点)，图像格式，tensor 的输出格式，后处理方式等等</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pegasus generate inputmeta --model best-sim.json --input-meta-output best-sim_inputmeta.yml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" alt="100ask-generateModelInput" src="/en/assets/images/100ask-generateModelInput-87a0ad201c0982a1c56e61793f16628f.gif" width="967" height="626" class="img_ev3q"></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pegasus generate postprocess-file --model best-sim.json --postprocess-file-output best-sim_postprocess_file.yml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" alt="100ask-generateModelOutput" src="/en/assets/images/100ask-generateModelOutput-791ae99cebffa8757cf67205d8fbf1c2.gif" width="967" height="626" class="img_ev3q"></p>
<p>修改 <code>best-sim_inputmeta.yml</code> 文件中的的 <code>scale</code> 参数为 <code>0.0039216(1/255)</code>，目的是对输入 <code>tensor</code> 进行归一化，和网络进行训练的时候是对应的。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">vi best-sim_inputmeta.yml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>修改过程如下图所示：</p>
<p><img loading="lazy" alt="100ask-changeInputYaml" src="/en/assets/images/100ask-changeInputYaml-4eab61ed6cd33c6afd9c3361dede662d.gif" width="967" height="626" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="154-量化">15.4 量化<a href="#154-量化" class="hash-link" aria-label="Direct link to 15.4 量化" title="Direct link to 15.4 量化">​</a></h3>
<p>生成量化表文件，使用非对称量化，uint8，修改 <code>--batch-size</code> 参数为你的 <code>dataset.txt</code> 里提供的图片数量。如果原始网络使用固定的batch_size，请使用固定的batch_size，如果原始网络使用可变batch_size，请将此参数设置为1。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pegasus quantize --model best-sim.json --model-data best-sim.data --batch-size 1 --device CPU --with-input-meta best-sim_inputmeta.yml --rebuild --model-quantize best-sim.quantize --quantizer asymmetric_affine --qtype uint8</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" alt="100ask-quantifyModel" src="/en/assets/images/100ask-quantifyModel-827d6598b5b0563b421c6747cc488124.gif" width="1072" height="681" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="155-预推理">15.5 预推理<a href="#155-预推理" class="hash-link" aria-label="Direct link to 15.5 预推理" title="Direct link to 15.5 预推理">​</a></h3>
<p>利用前文的量化表执行预推理，得到推理 <code>tensor</code></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pegasus inference --model best-sim.json --model-data best-sim.data --batch-size 1 --dtype quantized --model-quantize best-sim.quantize --device CPU --with-input-meta best-sim_inputmeta.yml --postprocess-file best-sim_postprocess_file.yml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" alt="100ask-PreInferenceModel" src="/en/assets/images/100ask-PreInferenceModel-bfa24ebbc4befa842dfea14d5b897704.gif" width="1209" height="681" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="156-导出模板代码与模型">15.6 导出模板代码与模型<a href="#156-导出模板代码与模型" class="hash-link" aria-label="Direct link to 15.6 导出模板代码与模型" title="Direct link to 15.6 导出模板代码与模型">​</a></h3>
<p>输出的模型可以在 <code>ovxilb/100ask-best-sim_nbg_unify</code> 文件夹中找到<code>network_binary.nb</code>模型文件。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pegasus export ovxlib --model best-sim.json --model-data best-sim.data --dtype quantized --model-quantize best-sim.quantize --batch-size 1 --save-fused-graph --target-ide-project &#x27;linux64&#x27; --with-input-meta best-sim_inputmeta.yml --output-path ovxilb/100ask-best-sim/100ask-simprj --pack-nbg-unify --postprocess-file best-sim_postprocessmeta.yml --optimize &quot;VIP9000PICO_PID0XEE&quot; --viv-sdk ${VIV_SDK}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" alt="100ask-Export-NBModel" src="/en/assets/images/100ask-Export-NBModel-0138a82986a4721e2baa0dffe708478b.gif" width="1446" height="765" class="img_ev3q"></p>
<p>可以进入下图所示目录中将<code>network_binary.nb</code>模型文件拷贝出来备用。</p>
<p><img loading="lazy" alt="100ask-NBModelDir" src="/en/assets/images/100ask-NBModelDir-300044417c271cd70ba05bca3a9be848.gif" width="1333" height="327" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="16端侧部署">16.端侧部署<a href="#16端侧部署" class="hash-link" aria-label="Direct link to 16.端侧部署" title="Direct link to 16.端侧部署">​</a></h2>
<p>这里引用上一篇《<a href="https://forums.100ask.net/t/topic/3648" target="_blank" rel="noopener noreferrer">DongshanPI-AICT开发板支持yolov5模型部署</a>》我们编写的yolov5端侧部署程序，这里进入端侧部署程序文件夹中拷贝一份新程序进行修改。主要修改<code>vnn_post_process.cpp</code>程序。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="161-修改draw_objects函数">16.1 修改<code>draw_objects</code>函数<a href="#161-修改draw_objects函数" class="hash-link" aria-label="Direct link to 161-修改draw_objects函数" title="Direct link to 161-修改draw_objects函数">​</a></h3>
<p>修改<code>draw_objects</code>函数中的类名，这里我训练的模型的类别分别是<code>T113、K510、V853</code></p>
<p><img loading="lazy" alt="image-20230629180241351" src="/en/assets/images/image-20230629180241351-539575a210441f26a475712300135f19.png" width="742" height="241" class="img_ev3q"></p>
<p>类别名称需要yolov5-6.0项目<code>data</code>目录下<code>data.yaml</code>对应</p>
<p><img loading="lazy" alt="image-20230629180515157" src="/en/assets/images/image-20230629180515157-2127ef47d9055c7997ea37dc39380ca1.png" width="395" height="112" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="162-修改generate_proposals函数">16.2 修改<code>generate_proposals</code>函数<a href="#162-修改generate_proposals函数" class="hash-link" aria-label="Direct link to 162-修改generate_proposals函数" title="Direct link to 162-修改generate_proposals函数">​</a></h3>
<p>修改<code>generate_proposals</code>函数中的类类别数量为您类别数量。假设我训练的类别总共有<code>T113、K510、V853</code>，这3个类别，修改为3即可。</p>
<p><img loading="lazy" alt="image-20230629180707567" src="/en/assets/images/image-20230629180707567-81b5cd41000a1ab38638231e34afce70.png" width="974" height="195" class="img_ev3q"></p>
<p>修改后的文件如下所示：</p>
<p><img loading="lazy" alt="100ask-YOLOV5Dir" src="/en/assets/images/100ask-YOLOV5Dir-468be32bd5740fe5eab70e60a96903ad.gif" width="1586" height="704" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="163-编译">16.3 编译<a href="#163-编译" class="hash-link" aria-label="Direct link to 16.3 编译" title="Direct link to 16.3 编译">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> book@100ask:~/workspaces/tina-v853-open$ source build/envsetup.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> book@100ask:~/workspaces/tina-v853-open$ lunch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ...1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>进入menuconfig，输入</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> make menuconfig</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>进入如下目录中，选中yolov5-100ask配置</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; 100ask </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	&gt; NPU</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		&lt;*&gt; yolov5-100ask......................................... yolov5-100ask demo</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" alt="image-20230629185606559" src="/en/assets/images/image-20230629185606559-3ef2eae7e56a83b8c74311159dcde70e.png" width="1333" height="715" class="img_ev3q"></p>
<p>编译并生成镜像</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> book@100ask:~/workspaces/tina-v853-open$ make</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> book@100ask:~/workspaces/tina-v853-open$ pack</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>编译完成后使用全志烧写工具烧录镜像。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="164-测试">16.4 测试<a href="#164-测试" class="hash-link" aria-label="Direct link to 16.4 测试" title="Direct link to 16.4 测试">​</a></h3>
<p><strong>主机端：</strong></p>
<p>​	传入<code>640*640</code>的图像文件和<code>network_binary.nb</code>模型文件</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">book@100ask:~/workspaces/testImg$ adb push test-100ask.jpg /mnt/UDISK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">test-100ask.jpg: 1 file pushed. 0.6 MB/s (51039 bytes in 0.078s)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">book@100ask:~/workspaces/testImg$ adb push network_binary.nb /mnt/UDISK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">network_binary.nb: 1 file pushed. 0.7 MB/s (7409024 bytes in 10.043s)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>开发板端：</strong></p>
<p>进入/mnt/UDISK/目录下</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@TinaLinux:/# cd /mnt/UDISK/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@TinaLinux:/mnt/UDISK# ls</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lost+found         network_binary.nb  overlay            test-100ask.jpg</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>运行yolov5检测程序</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">yolov5-100ask network_binary.nb test-100ask.jpg</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" alt="image-20230629190424474" src="/en/assets/images/image-20230629190424474-c0d036582ded55d4c6354022526de7f1.png" width="936" height="702" class="img_ev3q"></p>
<p>执行完成后会在当前目录下生成输出文件<code>yolov5_out.jpg</code></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@TinaLinux:/mnt/UDISK# ls</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lost+found         overlay            yolov5_out.jpg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">network_binary.nb  test-100ask.jpg</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>主机端：</strong></p>
<p>拉取开发板端的输出图像<code>yolov5_out.jpg</code></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">book@100ask:~/workspaces/testImg$ adb pull /mnt/UDISK/yolov5_out.jpg ./</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/mnt/UDISK/yolov5_out.jpg: 1 file pulled. 0.8 MB/s (98685 bytes in 0.116s)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="17检测效果图">17.检测效果图<a href="#17检测效果图" class="hash-link" aria-label="Direct link to 17.检测效果图" title="Direct link to 17.检测效果图">​</a></h2>
<p><img loading="lazy" alt="image-20230629190722233" src="/en/assets/images/image-20230629190722233-c04867177b1897fc499b07594111cb88.png" width="704" height="773" class="img_ev3q"></p>
<p><img loading="lazy" alt="image-20230629191417157" src="/en/assets/images/image-20230629191417157-5e5bc255a31e4903fc9d8edd82f688d2.png" width="711" height="777" class="img_ev3q"></p>
<p><img loading="lazy" alt="image-20230629191450619" src="/en/assets/images/image-20230629191450619-0b1ee33949debb9b4153c27676a0b751.png" width="712" height="790" class="img_ev3q"></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/100askTeam/AllwinnerVisionIC-Docs/tree/main/docs/V853/part6/06-2_DeployYOLOV5CustomModel.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/en/docs/V853/part6/06-1_Yolov5ModelDeployment"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">yolov5模型部署指南</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/en/docs/category/常见问题"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">常见问题</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#0前言" class="table-of-contents__link toc-highlight">0.前言</a></li><li><a href="#1下载数据标注工具" class="table-of-contents__link toc-highlight">1.下载数据标注工具</a></li><li><a href="#2创建数据集目录" class="table-of-contents__link toc-highlight">2.创建数据集目录</a></li><li><a href="#3标注图像" class="table-of-contents__link toc-highlight">3.标注图像</a></li><li><a href="#4划分训练集和验证集" class="table-of-contents__link toc-highlight">4.划分训练集和验证集</a></li><li><a href="#5创建数据集配置文件" class="table-of-contents__link toc-highlight">5.创建数据集配置文件</a></li><li><a href="#6创建模型配置文件" class="table-of-contents__link toc-highlight">6.创建模型配置文件</a></li><li><a href="#6修改训练函数" class="table-of-contents__link toc-highlight">6.修改训练函数</a></li><li><a href="#7训练模型" class="table-of-contents__link toc-highlight">7.训练模型</a></li><li><a href="#8验证模型" class="table-of-contents__link toc-highlight">8.验证模型</a></li><li><a href="#9预测图像" class="table-of-contents__link toc-highlight">9.预测图像</a></li><li><a href="#10导出onnx模型" class="table-of-contents__link toc-highlight">10.导出ONNX模型</a></li><li><a href="#11简化模型" class="table-of-contents__link toc-highlight">11.简化模型</a></li><li><a href="#13查看模型" class="table-of-contents__link toc-highlight">13.查看模型</a></li><li><a href="#14验证模型" class="table-of-contents__link toc-highlight">14.验证模型</a></li><li><a href="#15转换模型" class="table-of-contents__link toc-highlight">15.转换模型</a><ul><li><a href="#151-创建工作目录" class="table-of-contents__link toc-highlight">15.1 创建工作目录</a></li><li><a href="#152-导入模型" class="table-of-contents__link toc-highlight">15.2 导入模型</a></li><li><a href="#153-生成-yml-文件" class="table-of-contents__link toc-highlight">15.3 生成 YML 文件</a></li><li><a href="#154-量化" class="table-of-contents__link toc-highlight">15.4 量化</a></li><li><a href="#155-预推理" class="table-of-contents__link toc-highlight">15.5 预推理</a></li><li><a href="#156-导出模板代码与模型" class="table-of-contents__link toc-highlight">15.6 导出模板代码与模型</a></li></ul></li><li><a href="#16端侧部署" class="table-of-contents__link toc-highlight">16.端侧部署</a><ul><li><a href="#161-修改draw_objects函数" class="table-of-contents__link toc-highlight">16.1 修改<code>draw_objects</code>函数</a></li><li><a href="#162-修改generate_proposals函数" class="table-of-contents__link toc-highlight">16.2 修改<code>generate_proposals</code>函数</a></li><li><a href="#163-编译" class="table-of-contents__link toc-highlight">16.3 编译</a></li><li><a href="#164-测试" class="table-of-contents__link toc-highlight">16.4 测试</a></li></ul></li><li><a href="#17检测效果图" class="table-of-contents__link toc-highlight">17.检测效果图</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 100askTeam, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>