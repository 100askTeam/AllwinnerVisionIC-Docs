"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[7201],{470:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>h,contentTitle:()=>i,default:()=>o,frontMatter:()=>l,metadata:()=>c,toc:()=>x});var r=s(85893),d=s(11151);const l={sidebar_position:5},i="SDK \u7cfb\u7edf\u8d44\u6e90\u914d\u7f6e",c={id:"V821/part2/01-5_SDKSysRC",title:"SDK \u7cfb\u7edf\u8d44\u6e90\u914d\u7f6e",description:"\u5185\u5b58\u5212\u5206\u4e0e\u8c03\u6574",source:"@site/docs/V821/part2/01-5_SDKSysRC.md",sourceDirName:"V821/part2",slug:"/V821/part2/01-5_SDKSysRC",permalink:"/en/docs/V821/part2/01-5_SDKSysRC",draft:!1,unlisted:!1,editUrl:"https://github.com/100askTeam/AllwinnerVisionIC-Docs/tree/main/docs/V821/part2/01-5_SDKSysRC.md",tags:[],version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5},sidebar:"v821Sidebar",previous:{title:"SDK \u529f\u80fd\u914d\u7f6e",permalink:"/en/docs/V821/part2/01-4_SDKFunctionConfig"},next:{title:"SDK \u4e00\u952e\u914d\u7f6e\u547d\u4ee4",permalink:"/en/docs/V821/part2/01-6_SDKOCC"}},h={},x=[{value:"\u5185\u5b58\u5212\u5206\u4e0e\u8c03\u6574",id:"\u5185\u5b58\u5212\u5206\u4e0e\u8c03\u6574",level:2},{value:"ramparser \u4ecb\u7ecd",id:"ramparser-\u4ecb\u7ecd",level:3},{value:"\u9884\u7559\u5185\u5b58",id:"\u9884\u7559\u5185\u5b58",level:3},{value:"\u6ce8\u610f\u4e8b\u9879",id:"\u6ce8\u610f\u4e8b\u9879",level:3},{value:"SPI NOR \u4ecb\u8d28\u5e03\u5c40",id:"spi-nor-\u4ecb\u8d28\u5e03\u5c40",level:2},{value:"SPI NOR \u5e38\u7535\u5b58\u50a8\u4ecb\u8d28\u5e03\u5c40",id:"spi-nor-\u5e38\u7535\u5b58\u50a8\u4ecb\u8d28\u5e03\u5c40",level:3},{value:"SPI NOR \u5b58\u50a8\u4ecb\u8d28\u5e03\u5c40\u914d\u7f6e",id:"spi-nor-\u5b58\u50a8\u4ecb\u8d28\u5e03\u5c40\u914d\u7f6e",level:3}];function t(n){const e={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.a)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.h1,{id:"sdk-\u7cfb\u7edf\u8d44\u6e90\u914d\u7f6e",children:"SDK \u7cfb\u7edf\u8d44\u6e90\u914d\u7f6e"}),"\n",(0,r.jsx)(e.h2,{id:"\u5185\u5b58\u5212\u5206\u4e0e\u8c03\u6574",children:"\u5185\u5b58\u5212\u5206\u4e0e\u8c03\u6574"}),"\n",(0,r.jsx)(e.p,{children:"\u672c\u7ae0\u8282\u5c06\u8ba8\u8bba\u5728\u542f\u52a8\u8fc7\u7a0b\u4e2d\u7684\u5404\u4e2a\u9636\u6bb5\uff0c\u7269\u7406\u5185\u5b58\u7684\u5360\u7528\u53ca\u5176\u751f\u547d\u5468\u671f\uff0c\u91cd\u70b9\u5206\u6790\u5728\u5e94\u7528\u8fd0\u884c\u9636\u6bb5\uff0c\u7cfb\u7edf\u4e3a\u7528\u6237\u5f00\u53d1\u7559\u51fa\u7684\u5185\u5b58\u4f59\u91cf\uff0c\u4ee5\u53ca\u5178\u578b\u591a\u5a92\u4f53\u573a\u666f\u4e0b\u7684\u5185\u5b58\u5360\u7528\u60c5\u51b5\u3002\u540c\u65f6\uff0c\u8fd8\u5c06\u4ecb\u7ecdAW\u5185\u5b58\u7edf\u8ba1\u5de5\u5177ramparser\u7684\u4f7f\u7528\u65b9\u6cd5\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u4e0b\u6587\u4f1a\u4ecb\u7ecd\u5e38\u7535\u65b9\u6848\u4e0e\u5feb\u8d77\u65b9\u6848\u7684\u533a\u522b\uff0c\u5e38\u7535\u4ee3\u8868\u666e\u901a\u542f\u52a8\u901a\u8def\uff0c\u7cfb\u7edf\u5b8c\u6574\u542f\u52a8\u540e\u8fd0\u884c\u5e94\u7528\u7a0b\u5e8f\u3002\u5feb\u8d77\u4ee3\u8868\u5feb\u901f\u542f\u52a8\u901a\u8def\uff0c\u901a\u8fc7\u6df1\u5ea6\u4f18\u5316\u5b9a\u5236\u8fbe\u5230\u5feb\u901f\u542f\u52a8\u51fa\u56fe\u7684\u901f\u5ea6\u3002"}),"\n",(0,r.jsx)(e.h3,{id:"ramparser-\u4ecb\u7ecd",children:"ramparser \u4ecb\u7ecd"}),"\n",(0,r.jsx)(e.p,{children:"SDK\u63d0\u4f9b\u4e86ramparser\u5de5\u5177\u7528\u4e8e\u5185\u5b58\u7edf\u8ba1\u3002ramparser\u4f1a\u6309\u6a21\u5757\u5bf9\u5185\u6838\u3001\u5a92\u4f53\uff08\u5305\u62ecion\u5185\u5b58\u5360\u7528\uff09\u4ee5\u53ca\u7528\u6237\u8fdb\u7a0b\u7684\u5185\u5b58\u4f7f\u7528\u60c5\u51b5\u8fdb\u884c\u8be6\u7ec6\u7edf\u8ba1\u3002\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528ramparser -a\u547d\u4ee4\u5bf9\u6574\u4f53\u5185\u5b58\u8fdb\u884c\u7edf\u8ba1\u5206\u6790\uff0c\u800c\u4f7f\u7528ramparser -p pid\u547d\u4ee4\u5219\u53ef\u4ee5\u8ddf\u8e2a\u7279\u5b9a\u8fdb\u7a0b\u7684\u5185\u5b58\u4f7f\u7528\u60c5\u51b5\uff0c\u5e2e\u52a9\u5b9a\u4f4d\u5185\u5b58\u76f8\u5173\u95ee\u9898\u3002"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-text",children:"Usage : ramparser [option]\nOptions:\n      -k all                       : \u663e\u793a\u5185\u6838\u7a7a\u95f4\u5185\u5b58\u4f7f\u7528\u60c5\u51b5\uff1b\n      -k vma                       : \u663e\u793a\u5185\u6838\u7a7a\u95f4\u7684vmalloc\u5185\u5b58\u4f7f\u7528\u60c5\u51b5\uff1b\n      -k pagesort [input] [output] : \u6839\u636e\u5806\u6808\u8ffd\u8e2a\u6392\u5e8f\u9875\u9762\u6240\u6709\u8005\uff1b\n      -u                           : \u663e\u793a\u7528\u6237\u7a7a\u95f4\u5185\u5b58\u4f7f\u7528\u60c5\u51b5\uff1b\n      -a                           : \u663e\u793a\u5185\u6838\u7a7a\u95f4\u548c\u7528\u6237\u7a7a\u95f4\u7684\u5185\u5b58\u4f7f\u7528\u60c5\u51b5\uff1b\n      -p pid                       : \u663e\u793a\u6307\u5b9a\u8fdb\u7a0b\u7684\u8be6\u7ec6\u5185\u5b58\u4fe1\u606f\u5e76\u8f93\u51fa\u5230\u5c4f\u5e55\uff1b\n      -p all                       : \u663e\u793a\u6240\u6709\u8fdb\u7a0b\u7684\u5185\u5b58\u4f7f\u7528\u60c5\u51b5\uff0c\u7b49\u540c\u4e8e '-u'\uff1b\n      -r                           : \u663e\u793a\u6240\u6709\u9884\u7559\u5185\u5b58\uff1b\n      -s                           : \u6253\u5370size_pool\u4fe1\u606f\uff1b\n      -S unslab                    : \u6253\u5370slab\u5185\u5b58\u4fe1\u606f\uff1b\n      -v                           : \u6253\u5370\u7248\u672c\u4fe1\u606f\uff1b\n      -V                           : \u6253\u5370\u66f4\u591a\u7684\u8be6\u7ec6\u4fe1\u606f\uff1b\n"})}),"\n",(0,r.jsxs)(e.p,{children:["\u793a\u4f8b\u8f93\u51fa ",(0,r.jsx)(e.code,{children:"ramparser -a"})]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-text",children:"-----*****Mem Used Info For Kernel Space*****-----\n\nKernel stack      =    424 Kb\nKernel pagetables =     60 Kb\nKernel vmalloc    =   2960 Kb\nKernel modules    =      0 Kb\nKernel cma        =     64 Kb\nKernel dma_alloc  =      0 Kb (dma + dma pool + iommu)\n\nSlab               =   8292 Kb (recalim + unrecalim + alloc_pages)\n   slab_recalim    =   1876 Kb\n   slab_unrecalim  =   6416 Kb\n   slab buddy(>8K) =      0 Kb\n\nBuddy Pages  =   3884 Kb\n  lru_anon   =    248 Kb (\u2248 anon + shmem(anon) + mlock)\n    anon     =    256 Kb\n    shmem    =      4 Kb\n    mlock    =      0 Kb\n  lru_file   =   3636 Kb (\u2248 buffer + cached - shmem(file))\n    buffer   =   1332 Kb\n    cached   =   2308 Kb\n\ndmabuf          =    280 Kb\n   heap uncache =      0 Kb\n   heap         =      0 Kb\n   cma          =      0 Kb\n   ion          =    280 Kb\n   other        =      0 Kb\n\n\n-----*****Mem Used Info For User Space*****-----\n\nther number on the left is the actual allocated memory.\nther number on the right is the logic allocated memory.\ne.g.\n        4/16      : logic malloc 16K, but phys alloc 4K\n\nPid    Code+Rodata(Kb)    Data(Kb)      heap(Kb)      Stack(Kb)     mmap(Kb)       lib(Kb)    share(Kb)   pss(Kb) Process\n1          220/288          4/4           4/4           4/132         0/0         412/604            0       220 /sbin/init\n122         64/68           4/4           4/4           8/132        32/416       540/604            0       245 /bin/adbd\n177         36/44           4/4           4/4           8/132        16/272       560/744            0       308 wifi_daemon\n198        284/288          4/4           4/4           4/132         8/8         540/604            0       331 -/bin/sh\nRss total: 2.70 Mb , Pss total: 1.08 Mb\n\nsize pool info:\npool[0]: 264 KB of 23 MB uesed\n\nMem Used Summary(For kernel space only):\nMem    Total           64 Mb   (Free 10.44 Mb, Available 13.35 Mb)\nKernel Reserved         35.69 Mb   (Not Include Nomap Reserved mem)\nKernel Nomap Reserved    4.30 Mb\n\nWatermark:\n    normal: min 636K, low 792K, high 948K\n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\u5185\u6838\u7a7a\u95f4\u5185\u5b58\u4f7f\u7528\u60c5\u51b5"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u5185\u6838\u6808 (Kernel stack): 424 Kb"}),"\n",(0,r.jsx)(e.li,{children:"\u5185\u6838\u9875\u8868 (Kernel pagetables): 60 Kb"}),"\n",(0,r.jsx)(e.li,{children:"\u5185\u6838vmalloc (Kernel vmalloc): 2960 Kb"}),"\n",(0,r.jsx)(e.li,{children:"\u5185\u6838\u6a21\u5757 (Kernel modules): 0 Kb"}),"\n",(0,r.jsx)(e.li,{children:"\u5185\u6838CMA (Kernel cma): 64 Kb"}),"\n",(0,r.jsx)(e.li,{children:"\u5185\u6838DMA\u5206\u914d (Kernel dma_alloc): 0 Kb\uff08\u5305\u62ec DMA\u3001DMA\u6c60\u548cIOMMU\uff09"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Slab\u5206\u914d"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\u603bSlab\u5185\u5b58: 8292 Kb","\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"slab_recalim: 1876 Kb"}),"\n",(0,r.jsx)(e.li,{children:"slab_unrecalim: 6416 Kb"}),"\n",(0,r.jsx)(e.li,{children:"slab buddy (>8K): 0 Kb"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Buddy\u9875\u9762"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\u603bBuddy\u9875\u9762\u5185\u5b58: 3884 Kb","\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["lru_anon (\u533f\u540d\u9875\u9762): 248 Kb","\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"anon: 256 Kb"}),"\n",(0,r.jsx)(e.li,{children:"shmem (\u5171\u4eab\u5185\u5b58): 4 Kb"}),"\n",(0,r.jsx)(e.li,{children:"mlock (\u9501\u9875): 0 Kb"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["lru_file (\u6587\u4ef6\u9875\u9762): 3636 Kb","\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"buffer (\u7f13\u51b2\u533a): 1332 Kb"}),"\n",(0,r.jsx)(e.li,{children:"cached (\u7f13\u5b58): 2308 Kb"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"DMABUF\u5185\u5b58\u4f7f\u7528"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\u603b\u5185\u5b58: 280 Kb","\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"ion: 280 Kb"}),"\n",(0,r.jsx)(e.li,{children:"\u5176\u4ed6: 0 Kb"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\u7528\u6237\u7a7a\u95f4\u5185\u5b58\u4f7f\u7528\u60c5\u51b5"})}),"\n",(0,r.jsx)(e.p,{children:"\u4ee5\u4e0b\u4e3a\u6bcf\u4e2a\u8fdb\u7a0b\u7684\u5185\u5b58\u5206\u914d\u60c5\u51b5\uff0c\u5217\u51fa\u4e86\u5b9e\u9645\u5206\u914d\u5185\u5b58\u548c\u903b\u8f91\u5206\u914d\u5185\u5b58\u3002"}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:(0,r.jsx)(e.strong,{children:"Metric"})}),(0,r.jsx)(e.th,{children:(0,r.jsx)(e.strong,{children:"Pid 1 (/sbin/init)"})}),(0,r.jsx)(e.th,{children:(0,r.jsx)(e.strong,{children:"Pid 122 (/bin/adbd)"})}),(0,r.jsx)(e.th,{children:(0,r.jsx)(e.strong,{children:"Pid 177 (wifi_daemon)"})}),(0,r.jsx)(e.th,{children:(0,r.jsx)(e.strong,{children:"Pid 198 (-/bin/sh)"})})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"Code+Rodata (Kb)"})}),(0,r.jsx)(e.td,{children:"220/288"}),(0,r.jsx)(e.td,{children:"64/68"}),(0,r.jsx)(e.td,{children:"36/44"}),(0,r.jsx)(e.td,{children:"284/288"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"Data (Kb)"})}),(0,r.jsx)(e.td,{children:"4/4"}),(0,r.jsx)(e.td,{children:"4/4"}),(0,r.jsx)(e.td,{children:"4/4"}),(0,r.jsx)(e.td,{children:"4/4"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"Heap (Kb)"})}),(0,r.jsx)(e.td,{children:"4/4"}),(0,r.jsx)(e.td,{children:"4/4"}),(0,r.jsx)(e.td,{children:"4/4"}),(0,r.jsx)(e.td,{children:"4/4"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"Stack (Kb)"})}),(0,r.jsx)(e.td,{children:"4/132"}),(0,r.jsx)(e.td,{children:"8/132"}),(0,r.jsx)(e.td,{children:"8/132"}),(0,r.jsx)(e.td,{children:"4/132"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"Mmap (Kb)"})}),(0,r.jsx)(e.td,{children:"0/0"}),(0,r.jsx)(e.td,{children:"32/416"}),(0,r.jsx)(e.td,{children:"16/272"}),(0,r.jsx)(e.td,{children:"8/8"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"Lib (Kb)"})}),(0,r.jsx)(e.td,{children:"412/604"}),(0,r.jsx)(e.td,{children:"540/604"}),(0,r.jsx)(e.td,{children:"560/744"}),(0,r.jsx)(e.td,{children:"540/604"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"Share (Kb)"})}),(0,r.jsx)(e.td,{children:"0"}),(0,r.jsx)(e.td,{children:"0"}),(0,r.jsx)(e.td,{children:"0"}),(0,r.jsx)(e.td,{children:"0"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"PSS (Kb)"})}),(0,r.jsx)(e.td,{children:"220"}),(0,r.jsx)(e.td,{children:"245"}),(0,r.jsx)(e.td,{children:"308"}),(0,r.jsx)(e.td,{children:"331"})]})]})]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Rss total: 2.70 Mb"}),"\n",(0,r.jsx)(e.li,{children:"Pss total: 1.08 Mb"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\u5185\u5b58\u6c60\u4fe1\u606f"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["size pool:","\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"pool[0]: 23 MB \u4e2d\u4f7f\u7528\u4e86 264 KB \u7684\u5185\u5b58"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\u5185\u6838\u7a7a\u95f4\u5185\u5b58\u603b\u7ed3"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\u603b\u5185\u5b58: 64 Mb","\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u7a7a\u95f2\u5185\u5b58 (Free): 10.44 Mb"}),"\n",(0,r.jsx)(e.li,{children:"\u53ef\u7528\u5185\u5b58 (Available): 13.35 Mb"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.li,{children:"\u5185\u6838\u4fdd\u7559\u5185\u5b58: 35.69 Mb"}),"\n",(0,r.jsx)(e.li,{children:"\u5185\u6838\u4e0d\u6620\u5c04\u4fdd\u7559\u5185\u5b58: 4.30 Mb"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\u6c34\u4f4d\u4fe1\u606f (Watermark)"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["normal (\u5e38\u89c4):","\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"min: 636 Kb"}),"\n",(0,r.jsx)(e.li,{children:"low: 792 Kb"}),"\n",(0,r.jsx)(e.li,{children:"high: 948 Kb"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"\u9884\u7559\u5185\u5b58",children:"\u9884\u7559\u5185\u5b58"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\u9884\u7559\u5185\u5b58\u914d\u7f6e\u6587\u4ef6"})}),"\n",(0,r.jsxs)(e.p,{children:["\u9884\u7559\u5185\u5b58\u662f\u5728 ",(0,r.jsx)(e.code,{children:"dts"})," \u8bbe\u5907\u6811\u4e0a\u8bbe\u7f6e\uff0c\u4ee5\u4e0b\u662f PERF2 \u677f\u7ea7 ",(0,r.jsx)(e.code,{children:"board.dts"})," \u7684\u8def\u5f84\uff1a"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-text",children:"device/config/chips/v821/configs/perf2/linux-5.4-ansc/board.dts\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u8bbe\u7f6e\u65b9\u6cd5\u662f"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-text",children:"reg(\u4fdd\u7559\u5185\u5b58) = < \u7269\u7406\u8d77\u59cb\u5730\u5740\u9ad832bit\uff0c\u7269\u7406\u8d77\u59cb\u5730\u5740\u4f4e32bit \u957f\u5ea6\u5927\u5c0f\u9ad832bit \u957f\u5ea6\u5927\u5c0f\u4f4e32bit> \n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\u9884\u7559\u5185\u5b58 e907_mem_fw"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.code,{children:"e907_mem_fw"}),"\uff1artos\u955c\u50cf\u5b58\u653e\u7a7a\u95f4\uff0c",(0,r.jsx)(e.strong,{children:"\u5728rtos\u4e0ekernel\u5efa\u7acb\u901a\u4fe1\u540e\u4f1a\u88ab kernel \u91ca\u653e."})]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.code,{children:"v821-perf2"})," \u5355\u76ee\u914d\u7f6e"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"e907_mem_fw: e907_mem_fw@81444000 {\n        /* boot0 & uboot0 load elf addr */\n        reg = <0x0 0x81444000 0x0 0x00200000>;\n};\n"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.code,{children:"perf2_fastboot_dual "}),"\u53cc\u76ee\u914d\u7f6e"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"e907_mem_fw: e907_mem_fw@81484000 {\n        /* boot0 & uboot0 load elf addr */\n        reg = <0x0 0x81484000 0x0 0x0025B000>;\n};\n"})}),"\n",(0,r.jsxs)(e.blockquote,{children:["\n",(0,r.jsx)(e.p,{children:"\u8fd9\u4e00\u5757\u914d\u7f6e\u5730\u5740\u5982\u679c\u4fee\u6539\uff0c\u4f1a\u5728\u7f16\u8bd1\u7684\u65f6\u5019\uff0c\u81ea\u52a8\u4fee\u6539boot0\u7684\u914d\u7f6e\u5b8f\uff0c\u8ba9boot0\u52a0\u8f7drtos_fw\u7684\u5730\u5740\u8ddf\u7740bord.dts\u53d8\u5316\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"autogen_dts_info.h:16:#define DTS_RESERVED_e907_mem_fw_ADDR 0x81484000\n"})}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\u9884\u7559\u5185\u5b58 rv_ddr_reserved"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.code,{children:"rv_ddr_reserved"}),"\uff1artos\u7cfb\u7edf\u7684\u8fd0\u884c\u7a7a\u95f4"]}),"\n",(0,r.jsx)(e.p,{children:"v821-perf2 \u5355\u76ee\u914d\u7f6e"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"rv_ddr_reserved: rvddrreserved@81000000 {\n        reg = <0x0 0x81000000 0x0 0x400000>;\n        no-map;/*\u4e0d\u4f1a\u88ab\u6620\u5c04\u5230linux\u7cfb\u7edf\uff0clinux\u7cfb\u7edf\u5b8c\u5168\u770b\u4e0d\u5230\u8be5\u5185\u5b58*/\n};\n"})}),"\n",(0,r.jsx)(e.p,{children:"perf2_fastboot_dual \u53cc\u76ee\u914d\u7f6e"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"rv_ddr_reserved: rvddrreserved@81000000 {\n        reg = <0x0 0x81000000 0x0 0x440000>;\n        no-map;\n};\n"})}),"\n",(0,r.jsx)(e.p,{children:"rtos\u7684\u8fd0\u884c\u5730\u5740\u9700\u8981\u518drtos\u7f16\u8bd1\u7684\u65f6\u5019\u6307\u5b9a\u3002\u8fd9\u4e2a\u4fdd\u7559\u5730\u5740\u5e94\u8be5\u548crtos\u4ee3\u7801\u4ed3\u5e93\u4e2d\u7684defconfig\u914d\u7f6e\u6587\u4ef6\u4e00\u81f4\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-text",children:"lichee/rtos/projects/v821_e907/{LICHEE_BOARD}/defconfig\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u914d\u7f6e\u5982\u4e0b"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-text",children:"CONFIG_ARCH_START_ADDRESS=0x81000000\nCONFIG_ARCH_MEM_LENGTH=0x400000\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u5927\u6838\u8d77\u6765\u540e\u4f1a\u628a\u4e0b\u9762\u5c0f\u8282\u4ecb\u7ecd\u7684\u4fdd\u7559\u5730\u5740\u4f20\u9012\u7ed9\u5c0f\u6838\uff0c\u8ba9\u5c0f\u6838\u4f7f\u7528\u6b63\u786e\u7684\u4fdd\u7559\u5730\u5740\u3002\u5c0f\u6838\u63a5\u6536\u5230\u5730\u5740\u540e\u521d\u59cb\u5316\u4f1a\u6709\u5982\u4e0b\u6253\u5370\uff1a"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{alt:"rtos_map_ddr\u6253\u5370",src:s(73289).Z+"",width:"974",height:"532"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\u9884\u7559\u5185\u5b58rv_vdev0buffer"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.code,{children:"rv_vdev0buffer"}),"\uff1a\u7528\u4e8e\u548cE907\u901a\u4fe1\u7684\u5171\u4eab\u5185\u5b58\uff0c\u4e00\u822c256K\u3002"]}),"\n",(0,r.jsx)(e.p,{children:"v821-perf2 \u5355\u76ee\u914d\u7f6e"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:'/*\n* The name should be "vdev%dbuffer".\n* Its size should be not less than\n*     RPMSG_BUF_SIZE * (num of buffers in a vring) * 2\n*   = 512 * (num of buffers in a vring) * 2\n*/\nrv_vdev0buffer: vdev0buffer@81400000 {\n        compatible = "shared-dma-pool";\n        reg = <0x0 0x81400000 0x0 0x40000>;\n        no-map;/*\u4e0d\u4f1a\u88ab\u6620\u5c04\u5230linux\u7cfb\u7edf\uff0clinux\u7cfb\u7edf\u5b8c\u5168\u770b\u4e0d\u5230\u8be5\u5185\u5b58*/\n};\n'})}),"\n",(0,r.jsx)(e.p,{children:"perf2_fastboot_dual \u53cc\u76ee\u914d\u7f6e"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:'rv_vdev0buffer: vdev0buffer@81440000 {\n        compatible = "shared-dma-pool";\n        reg = <0x0 0x81440000 0x0 0x40000>;\n        no-map;\n};\n'})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\u9884\u7559\u5185\u5b58rv_vdev0buffer/rv_vdev0vring1"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.code,{children:"rv_vdev0buffer/rv_vdev0vring1"}),"\uff1a\u5b58\u653e\u548cE907\u901a\u4fe1\u76f8\u5173\u7684\u63a7\u5236\u4fe1\u606f\uff0c\u4e00\u822c\u6bcf\u4e2a8K\u3002"]}),"\n",(0,r.jsx)(e.p,{children:"v821-perf2 \u5355\u76ee\u914d\u7f6e"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:'/*\n* The name should be "vdev%dvring%d".\n* The size of each should be not less than\n*     PAGE_ALIGN(vring_size(num, align))\n*   = PAGE_ALIGN(16 * num + 6 + 2 * num + (pads for align) + 6 + 8 * num)\n*\n* (Please refer to the vring layout in include/uapi/linux/virtio_ring.h)\n*/\n\nrv_vdev0vring0: vdev0vring0@81440000 {\n        reg = <0x0 0x81440000 0x0 0x2000>;\n        no-map;/*\u4e0d\u4f1a\u88ab\u6620\u5c04\u5230linux\u7cfb\u7edf\uff0clinux\u7cfb\u7edf\u5b8c\u5168\u770b\u4e0d\u5230\u8be5\u5185\u5b58*/\n};\n\nrv_vdev0vring1: vdev0vring1@81442000 {\n        reg = <0x0 0x81442000 0x0 0x2000>;\n        no-map;/*\u4e0d\u4f1a\u88ab\u6620\u5c04\u5230linux\u7cfb\u7edf\uff0clinux\u7cfb\u7edf\u5b8c\u5168\u770b\u4e0d\u5230\u8be5\u5185\u5b58*/\n};\n'})}),"\n",(0,r.jsx)(e.p,{children:"perf2_fastboot_dual \u53cc\u76ee\u914d\u7f6e"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"rv_vdev0vring0: vdev0vring0@81480000 {\n        reg = <0x0 0x81480000 0x0 0x2000>;\n        no-map;\n};\n\nrv_vdev0vring1: vdev0vring1@81482000 {\n        reg = <0x0 0x81482000 0x0 0x2000>;\n        no-map;\n};\n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\u9884\u7559\u5185\u5b58e907_share_irq_table"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.code,{children:"e907_share_irq_table"}),"\uff1a\u5b58\u653eGPIO\u4e2d\u65ad\u4fe1\u606f\uff0crtos\u636e\u6b64\u5224\u65adGPIO\u662f\u5426\u5c5e\u4e8e\u81ea\u5df1\uff0c8K\u3002"]}),"\n",(0,r.jsx)(e.p,{children:"v821-perf2 \u5355\u76ee\u914d\u7f6e"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"e907_share_irq_table: share_irq_table@81644000 {\n        reg = <0x0 0x81644000 0x0 0x2000>;\n        no-map;/*\u4e0d\u4f1a\u88ab\u6620\u5c04\u5230linux\u7cfb\u7edf\uff0clinux\u7cfb\u7edf\u5b8c\u5168\u770b\u4e0d\u5230\u8be5\u5185\u5b58*/\n};\n"})}),"\n",(0,r.jsx)(e.p,{children:"perf2_fastboot_dual \u53cc\u76ee\u914d\u7f6e"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"e907_share_irq_table: share_irq_table@816EE000 {\n        reg = <0x0 0x816EE000 0x0 0x2000>;\n        no-map;\n};\n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\u9884\u7559\u5185\u5b58e907_rpbuf_reserved"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.code,{children:"e907_rpbuf_reserved"}),":\u8be5\u5185\u5b58\u9884\u7559\u662f\u4e3a\u4e24\u6838\u4e4b\u95f4\u6d88\u606f\u901a\u8baf\u3002"]}),"\n",(0,r.jsx)(e.p,{children:"v821-perf2 \u5355\u76ee\u914d\u7f6e"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:'e907_rpbuf_reserved:e907_rpbuf@81646000 {\n        compatible = "shared-dma-pool";\n        reg = <0x0 0x81646000 0x0 0x20000>;\n        no-map; /*\u4e0d\u4f1a\u88ab\u6620\u5c04\u5230linux\u7cfb\u7edf\uff0clinux\u7cfb\u7edf\u5b8c\u5168\u770b\u4e0d\u5230\u8be5\u5185\u5b58*/\n};\n'})}),"\n",(0,r.jsx)(e.p,{children:"perf2_fastboot_dual \u53cc\u76ee\u914d\u7f6e"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:'e907_rpbuf_reserved:e907_rpbuf@816F0000 {\n        compatible = "shared-dma-pool";\n        reg = <0x0 0x816F0000 0x0 0x40000>;\n        no-map;\n};\n'})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\u9884\u7559\u5185\u5b58isp_dram_reserved"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.code,{children:"isp_dram_reserved"}),"\uff1a \u7528\u4e8ertos\u5c0f\u6838vin\u6a21\u5757\u4f7f\u7528\u7684\u5185\u5b58\u6c60\u3002"]}),"\n",(0,r.jsx)(e.p,{children:"\u8fd9\u4e00\u5757\u4f1a\u6d89\u53cartos\u5c0f\u6838\u90a3\u8fb9\u51fa\u56febuf\uff0c\u5982\u679c\u5206\u8fa8\u7387\u6709\u53d8\u5316\u6216\u8005\u4f7f\u7528\u53cc\u76ee\uff0c\u9700\u8981\u8c03\u8282\u8fd9\u91cc\u7684\u9884\u7559\u7a7a\u95f4\u5927\u5c0f\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u91ca\u653e\uff1a\u5728kernel \u521d\u59cb\u5316vin/isp \u9a71\u52a8\u540e\u4f1a\u91ca\u653e\u8fd9\u5757\u533a\u57df\u3002"}),"\n",(0,r.jsx)(e.p,{children:"v821-perf2 \u5355\u76ee\u914d\u7f6e"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"isp_dram_reserved:isp_dram@81666000 {\n        reg = <0x0 0x81666000 0x0 0x0069A000>;\n};\n"})}),"\n",(0,r.jsx)(e.p,{children:"perf2_fastboot_dual \u53cc\u76ee\u914d\u7f6e"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"isp_dram_reserved:isp_dram@81730000 {\n        reg = <0x0 0x81730000 0x0 0x005d0000>;\n};\n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\u9884\u7559\u5185\u5b58size_pool/cma\uff08\u53ef\u6839\u636e\u65b9\u6848\u9700\u8981\u4fee\u6539\uff09"})}),"\n",(0,r.jsx)(e.p,{children:"\u8fd9\u4e24\u4e2a\u90fd\u662f\u8bbe\u7f6e ION \u5185\u5b58\u7684\uff0c \u8fd9\u91cc ION \u5185\u5b58\u6c60\u662f\u7ed9 Linux \u97f3\u89c6\u9891\u7b49\u591a\u5a92\u4f53\u4f7f\u7528\u7684\u3002"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"CMA\u5185\u5b58\uff1aCMA\uff08Contiguous Memory Allocator\uff09\u5185\u5b58\u662f\u4e00\u79cd\u7528\u4e8e\u5206\u914d\u8fde\u7eed\u7269\u7406\u5185\u5b58\u7684\u673a\u5236\u3002CMA\u901a\u5e38\u7528\u4e8e\u8bbe\u5907\u9a71\u52a8\u7a0b\u5e8f\u6216\u5176\u4ed6\u9700\u8981\u5927\u5757\u8fde\u7eed\u5185\u5b58\u7684\u573a\u666f\uff0c\u4f8b\u5982\u56fe\u5f62\u5904\u7406\u6216\u89c6\u9891\u5904\u7406\u3002\u9664\u4e86\u591a\u5a92\u4f53\u7533\u8bf7\u4f7f\u7528\uff0c\u5728\u7cfb\u7edf\u5185\u5b58\u4e0d\u8db3\u60c5\u51b5\u4e0b\uff0cLinux\u7cfb\u7edf\u4e5f\u53ef\u80fd\u7533\u8bf7\u8be5\u5185\u5b58\u7ed9\u81ea\u5df1\u4f7f\u7528\uff1b"}),"\n",(0,r.jsx)(e.li,{children:"size_pool\uff1a\u5168\u5fd7\u81ea\u5df1\u5b9a\u4e49\u7684 ION \u5185\u5b58\u6c60\uff0c\u5b83\u53ea\u7ed9\u7279\u5b9a\u7533\u8bf7\u5b83\u7684\u4eba\u4f7f\u7528\uff0cLinux\u7cfb\u7edf\u65e0\u6cd5\u4f7f\u7528\u3002"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"v821-perf2 \u5355\u76ee\u914d\u7f6e"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"size_pool {\n        reg = <0 0x82000000 0 0x01400000>;\n};\n\nlinux,cma {\n        size = <0x0 0x400000>;\n};\n"})}),"\n",(0,r.jsx)(e.p,{children:"perf2_fastboot_dual \u53cc\u76ee\u914d\u7f6e"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"size_pool {\n        reg = <0 0x82000000 0 0x01400000>;\n};\n\nlinux,cma {\n        size = <0x0 0x400000>;\n};\n"})}),"\n",(0,r.jsx)(e.p,{children:"size_pool \u9664\u4e86\u5728\u5185\u5b58\u4e0a\u5148\u7559\u51fa\u4e00\u6bb5\u7a7a\u95f4\u9884\u7559\u3002\u5176\u7a7a\u95f4\u4f7f\u7528\u4e5f\u88abheap_size_pool\u63cf\u8ff0\u7684\u6a21\u5757\u7ba1\u7406\u7740\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:'heap_size_pool@0{\n        compatible = "allwinner,size_pool";\n        heap-name  = "size_pool";\n        heap-id    = <0x7>;\n        heap-base  = <0x82000000>;  //size_pool\u8d77\u59cb\u5730\u5740\n        heap-size  = <0x01400000>;  //size_pool\u7684\u5927\u5c0f\n        heap-type  = "ion_size_pool";\n        thrs = <512>; //\u8d70cma\u5206\u914d\u9608\u503c\n        sizes = <0 20480>;  //size_pool\u7684\u5927\u5c0f\uff0c\u5355\u4f4dM\n        fall_to_big_pool = <1>;\n};\n'})}),"\n",(0,r.jsx)(e.p,{children:"\u5982\u679c\u8981\u6539size_pool \u5185\u5b58\u6c60\u5927\u5c0f\uff0c\u9700\u8981\u6539\u4e09\u4e2a\u5730\u65b9\uff1a"}),"\n",(0,r.jsx)(e.p,{children:"\uff081\uff09size_pool\u4e2dreg\u7684\u5927\u5c0f\uff1b \uff082\uff09heap_size_pool\u4e2dheap-size \uff083\uff09sizes\u7684\u5927\u5c0f\u6570\u503c\uff1b"}),"\n",(0,r.jsx)(e.p,{children:"ION \u5185\u5b58\u5206\u914d\u89c4\u683c\u5982\u4e0b\u56fe\u6240\u793a\uff1a"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{alt:"image-20250113145238945",src:s(44556).Z+"",width:"1260",height:"699"})}),"\n",(0,r.jsx)(e.h3,{id:"\u6ce8\u610f\u4e8b\u9879",children:"\u6ce8\u610f\u4e8b\u9879"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u5c0f\u5185\u5b58\u5206\u914d\u5230CMA\u4e0a\uff0c\u53ef\u4ee5\u6709\u6548\u7684\u9632\u6b62 size_pool \u4ea7\u751f\u5185\u5b58\u788e\u7247\u3002"}),"\n",(0,r.jsx)(e.li,{children:"\u4ee5\u4e0a\u4ecb\u7ecd\u7684\u4fdd\u7559\u5185\u5b58\u914d\u7f6e\uff0c\u9664\u4e86 size_pool \u548c cma \u7684\u5185\u5b58\u6c60\u5927\u5c0f\u53ef\u4ee5\u968f\u65b9\u6848\u66f4\u6539\uff0c\u5176\u4ed6\u4fdd\u7559\u5185\u5b58\u5df2\u89c4\u5212\u597d\uff0c\u8bf7\u52ff\u968f\u610f\u66f4\u6539\u3002\u5426\u5219\u5f88\u5bb9\u6613\u5f15\u8d77\u8e29\u5185\u5b58\u800c\u5bfc\u81f4\u6570\u636e\u5f02\u5e38\u6216\u8005CPU\u6b7b\u673a\u7b49\u60c5\u51b5\u3002"}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"spi-nor-\u4ecb\u8d28\u5e03\u5c40",children:"SPI NOR \u4ecb\u8d28\u5e03\u5c40"}),"\n",(0,r.jsx)(e.h3,{id:"spi-nor-\u5e38\u7535\u5b58\u50a8\u4ecb\u8d28\u5e03\u5c40",children:"SPI NOR \u5e38\u7535\u5b58\u50a8\u4ecb\u8d28\u5e03\u5c40"}),"\n",(0,r.jsxs)(e.p,{children:["SPI NOR \u4ecb\u8d28\u5feb\u542f\u7cfb\u7edf\u7684\u5b58\u50a8\u5e03\u5c40\uff0c\u4ece",(0,r.jsx)(e.strong,{children:"\u5206\u5272\u7ebf\u2460"}),"\u5206\u5f00\u6765\u770b\uff0c\u53ef\u4ee5\u5206\u4e24\u4e2a\u533a\u57df"]}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:["\u5206\u5272\u7ebf\u2460\u5de6\u8fb9\uff08\u767d\u8272\u65b9\u683c\uff09\uff1a\u662f ",(0,r.jsx)(e.code,{children:"boot0/uboot"})," \u542f\u52a8\u5206\u533a\uff1b \u5b83\u7684\u533a\u57df\u5212\u5206\u7531 ",(0,r.jsx)(e.code,{children:"uboot-board.dts"})," \u548c ",(0,r.jsx)(e.code,{children:"boot0"}),"\u6e90\u7801\u7ba1\u7406\uff1b \u4ece\u7528\u6237\u5c42\u770b\u5b83\u662f ",(0,r.jsx)(e.code,{children:"/dev/mtd0"}),"\u5206\u533a\u3002\u662f\u88f8\u5206\u533a\u3002"]}),"\n",(0,r.jsxs)(e.li,{children:["\u5206\u5272\u7ebf\u2460\u53f3\u8fb9\uff08\u6a59\u8272\u65b9\u683c\uff09\uff1a\u662f\u7528\u6237\u5b9a\u4e49\u7684\u5206\u533a\uff1b\u5b83\u7684\u533a\u57df\u5212\u5206\u7531 ",(0,r.jsx)(e.code,{children:"sys_partition_nor.fex"})," \u7ba1\u7406\uff1b\u5982 ",(0,r.jsx)(e.code,{children:"boot"})," \u5206\u533a\u653e\u5185\u6838\u955c\u50cf\uff0c",(0,r.jsx)(e.code,{children:"env"})," \u5206\u533a\u653e",(0,r.jsx)(e.code,{children:"env"}),"\u955c\u50cf\uff1b\u4ece\u7528\u6237\u5c42\u770b\uff0c\u4ed6\u4eec\u662f",(0,r.jsx)(e.code,{children:"/dev/mtd1"}),"\u3001",(0,r.jsx)(e.code,{children:"/dev/mtd2"})]}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{alt:"image-20250113145153900",src:s(32091).Z+"",width:"1262",height:"343"})}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:(0,r.jsx)(e.strong,{children:"\u5206\u533a\u540d\u79f0"})}),(0,r.jsx)(e.th,{children:(0,r.jsx)(e.strong,{children:"\u63cf\u8ff0"})})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"boot0"})}),(0,r.jsxs)(e.td,{children:["\u5b58\u50a8 ",(0,r.jsx)(e.code,{children:"boot0"})," \u955c\u50cf\u6587\u4ef6\uff0c\u7531 SDK \u7f16\u8bd1\u751f\u6210\uff0c\u7528\u4e8e\u8bbe\u5907\u542f\u52a8\u7684\u521d\u59cb\u9636\u6bb5\u3002"]})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"boot_param"})}),(0,r.jsxs)(e.td,{children:["\u5b58\u50a8 ",(0,r.jsx)(e.code,{children:"spinor"})," \u548c ",(0,r.jsx)(e.code,{children:"DDR"})," \u4f18\u5316\u53c2\u6570\u3002"]})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"boot_package_nor"})}),(0,r.jsxs)(e.td,{children:["\u5b58\u50a8 ",(0,r.jsx)(e.code,{children:"opensbi"})," \u955c\u50cf\u7684\u5206\u533a\uff0c\u901a\u5e38\u7528\u4e8e\u5b58\u653e\u5e38\u7535\u4e0b\u7684 ",(0,r.jsx)(e.code,{children:"opensbi"})," \u548c ",(0,r.jsx)(e.code,{children:"uboot"}),"\u3002"]})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"gpt"})}),(0,r.jsx)(e.td,{children:"\u5b58\u50a8\u5206\u533a\u8868\uff0cNOR Flash \u6052\u5b9a\u5927\u5c0f\u4e3a 16KB\uff0c\u5305\u542b\u5206\u533a\u4fe1\u606f\u7528\u4e8e\u8bbe\u5907\u7ba1\u7406\u3002"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"boot"}),(0,r.jsx)(e.td,{children:"\u903b\u8f91 boot \u5206\u533a"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"env"}),(0,r.jsx)(e.td,{children:"\u903b\u8f91 env \u5206\u533a"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"rootfs"}),(0,r.jsx)(e.td,{children:"\u903b\u8f91 rootfs \u5206\u533a"})]})]})]}),"\n",(0,r.jsx)(e.h3,{id:"spi-nor-\u5b58\u50a8\u4ecb\u8d28\u5e03\u5c40\u914d\u7f6e",children:"SPI NOR \u5b58\u50a8\u4ecb\u8d28\u5e03\u5c40\u914d\u7f6e"}),"\n",(0,r.jsxs)(e.p,{children:["SPI NOR \u5b58\u50a8\u4ecb\u8d28\u5e03\u5c40\u7531 ",(0,r.jsx)(e.code,{children:"uboot-board.dts"})," \u7ba1\u7406\uff0c\u8fd9\u91cc\u4ee5\u5e38\u7535 PERF2 \u65b9\u6848\u4e3a\u4f8b\uff0c\u8bb2\u89e3\u914d\u7f6e\u76f8\u5173\u7ec6\u8282\u3002"]}),"\n",(0,r.jsx)(e.p,{children:"\u914d\u7f6e\u6587\u4ef6\u8def\u5f84\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-text",children:"device/config/chips/v821/configs/perf2/uboot-board.dts\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u914d\u7f6e\u5185\u5bb9\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:'nor_map {\n    flash_size = <16384>;\n    logic_offset = <608>; \n    secure_logic_offset = <2016>;\n    rtos_logic_offset = <2016>;\n    rtos_secure_logic_offset = <2016>;\n    boot_param_start = <272>; \n    boot_param_size = <8>;\n    uboot_start = <280>;\n    uboot_size = <328>;\n    boot0_start = <0>; \n    status = "okay";\n};\n'})}),"\n",(0,r.jsxs)(e.p,{children:["\u8fd9\u4e2a\u914d\u7f6e\u7247\u6bb5\u5b9a\u4e49\u4e86\u4e00\u4e2a ",(0,r.jsx)(e.strong,{children:"NOR Flash"})," \u5b58\u50a8\u6620\u5c04 (",(0,r.jsx)(e.code,{children:"nor_map"}),")\uff0c\u7528\u4e8e\u6307\u5b9a\u4e0d\u540c\u5206\u533a\u5728Flash\u5b58\u50a8\u4e2d\u7684\u8d77\u59cb\u4f4d\u7f6e\u548c\u5927\u5c0f\u3002\u4ee5\u4e0b\u662f\u6bcf\u4e2a\u53c2\u6570\u7684\u603b\u7ed3\uff1a"]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u914d\u7f6e\u9879\u89e3\u91ca"}),"\uff1a"]}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:(0,r.jsx)(e.strong,{children:"\u914d\u7f6e\u9879"})}),(0,r.jsx)(e.th,{children:(0,r.jsx)(e.strong,{children:"\u63cf\u8ff0"})}),(0,r.jsx)(e.th,{children:(0,r.jsx)(e.strong,{children:"\u5355\u4f4d"})}),(0,r.jsx)(e.th,{children:(0,r.jsx)(e.strong,{children:"\u503c"})})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"flash_size"})}),(0,r.jsx)(e.td,{children:"Flash \u5b58\u50a8\u7684\u603b\u5927\u5c0f"}),(0,r.jsx)(e.td,{children:"\u6247\u533a\uff08512\u5b57\u8282\uff09"}),(0,r.jsx)(e.td,{children:"16384"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"logic_offset"})}),(0,r.jsx)(e.td,{children:"\u903b\u8f91\u5206\u533a\u8868\u7684\u8d77\u59cb\u5730\u5740"}),(0,r.jsx)(e.td,{children:"\u6247\u533a\uff08512\u5b57\u8282\uff09"}),(0,r.jsx)(e.td,{children:"608"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"secure_logic_offset"})}),(0,r.jsx)(e.td,{children:"\u5b89\u5168\u542f\u52a8\u65b9\u6848\u7684\u903b\u8f91\u5206\u533a\u8868\u8d77\u59cb\u5730\u5740"}),(0,r.jsx)(e.td,{children:"\u6247\u533a\uff08512\u5b57\u8282\uff09"}),(0,r.jsx)(e.td,{children:"2016"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"rtos_logic_offset"})}),(0,r.jsx)(e.td,{children:"RTOS \u65b9\u6848\u7684\u903b\u8f91\u5206\u533a\u8868\u8d77\u59cb\u5730\u5740\uff08\u4e0d\u9002\u5408v821\u65b9\u6848\uff09"}),(0,r.jsx)(e.td,{children:"\u6247\u533a\uff08512\u5b57\u8282\uff09"}),(0,r.jsx)(e.td,{children:"2016"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"rtos_secure_logic_offset"})}),(0,r.jsx)(e.td,{children:"\u5b89\u5168\u542f\u52a8\u7684 RTOS \u903b\u8f91\u5206\u533a\u8d77\u59cb\u5730\u5740\uff08\u4e0d\u9002\u5408v821\u65b9\u6848\uff09"}),(0,r.jsx)(e.td,{children:"\u6247\u533a\uff08512\u5b57\u8282\uff09"}),(0,r.jsx)(e.td,{children:"2016"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"boot_param_start"})}),(0,r.jsx)(e.td,{children:"boot_param \u5206\u533a\u7684\u8d77\u59cb\u504f\u79fb"}),(0,r.jsx)(e.td,{children:"\u6247\u533a\uff08512\u5b57\u8282\uff09"}),(0,r.jsx)(e.td,{children:"272"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"boot_param_size"})}),(0,r.jsx)(e.td,{children:"boot_param \u5206\u533a\u7684\u5927\u5c0f"}),(0,r.jsx)(e.td,{children:"\u6247\u533a\uff08512\u5b57\u8282\uff09"}),(0,r.jsx)(e.td,{children:"8"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"uboot_start"})}),(0,r.jsx)(e.td,{children:"uboot \u5206\u533a\u7684\u8d77\u59cb\u504f\u79fb"}),(0,r.jsx)(e.td,{children:"\u6247\u533a\uff08512\u5b57\u8282\uff09"}),(0,r.jsx)(e.td,{children:"280"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"uboot_size"})}),(0,r.jsx)(e.td,{children:"uboot \u5206\u533a\u7684\u5927\u5c0f"}),(0,r.jsx)(e.td,{children:"\u6247\u533a\uff08512\u5b57\u8282\uff09"}),(0,r.jsx)(e.td,{children:"328"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"boot0_start"})}),(0,r.jsx)(e.td,{children:"boot0 \u5206\u533a\u7684\u8d77\u59cb\u504f\u79fb\uff08\u56fa\u5b9a\u4ece0\u5f00\u59cb\uff09"}),(0,r.jsx)(e.td,{children:"\u6247\u533a\uff08512\u5b57\u8282\uff09"}),(0,r.jsx)(e.td,{children:"0"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"status"})}),(0,r.jsx)(e.td,{children:"\u914d\u7f6e\u72b6\u6001"}),(0,r.jsx)(e.td,{children:"-"}),(0,r.jsx)(e.td,{children:'"okay"'})]})]})]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\u6240\u6709\u504f\u79fb\u548c\u5927\u5c0f\u7684\u5355\u4f4d\u662f ",(0,r.jsx)(e.strong,{children:"\u6247\u533a"}),"\uff0c\u6bcf\u4e2a\u6247\u533a\u4e3a ",(0,r.jsx)(e.strong,{children:"512 \u5b57\u8282"}),"\u3002"]}),"\n",(0,r.jsx)(e.li,{children:"\u5404\u5206\u533a\u7684\u8d77\u59cb\u5730\u5740\u548c\u5927\u5c0f\u90fd\u9700\u8981\u6309\u7167\u8bbe\u5907\u7684\u542f\u52a8\u8981\u6c42\u8fdb\u884c\u914d\u7f6e\uff0c\u786e\u4fdd\u5404\u5206\u533a\u5bf9\u9f50\u5e76\u6ee1\u8db3\u529f\u80fd\u9700\u6c42\u3002"}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:'status = "okay"'})," \u8868\u793a\u8be5\u914d\u7f6e\u9879\u6709\u6548\uff0c\u8bbe\u5907\u53ef\u4ee5\u6b63\u5e38\u5de5\u4f5c\u3002"]}),"\n"]})]})}function o(n={}){const{wrapper:e}={...(0,d.a)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(t,{...n})}):t(n)}},32091:(n,e,s)=>{s.d(e,{Z:()=>r});const r=s.p+"assets/images/image-20250113145153900-b5a78a12e059810bc9afd27e67839ce2-b5a78a12e059810bc9afd27e67839ce2.png"},44556:(n,e,s)=>{s.d(e,{Z:()=>r});const r=s.p+"assets/images/image-20250113145238945-23ed9608c3960b44c72709ca4bfcbf59-23ed9608c3960b44c72709ca4bfcbf59.png"},73289:(n,e,s)=>{s.d(e,{Z:()=>r});const r=s.p+"assets/images/rtos_map_ddr\u6253\u5370-17328578689081-f97454e2f68084c4f3bec4523911c8a0-f97454e2f68084c4f3bec4523911c8a0.png"},11151:(n,e,s)=>{s.d(e,{Z:()=>c,a:()=>i});var r=s(67294);const d={},l=r.createContext(d);function i(n){const e=r.useContext(l);return r.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function c(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(d):n.components||d:i(n.components),r.createElement(l.Provider,{value:e},n.children)}}}]);