"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[8117],{66810:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>r,contentTitle:()=>d,default:()=>p,frontMatter:()=>t,metadata:()=>c,toc:()=>l});var o=s(85893),i=s(11151);const t={sidebar_position:5},d="\u76ee\u6807\u68c0\u6d4b\u6a21\u578byolov3\u90e8\u7f72",c={id:"V853/part3/03-5_ObjectDetectionModelYolov3DGuide",title:"\u76ee\u6807\u68c0\u6d4b\u6a21\u578byolov3\u90e8\u7f72",description:"0.\u524d\u8a00",source:"@site/docs/V853/part3/03-5_ObjectDetectionModelYolov3DGuide.md",sourceDirName:"V853/part3",slug:"/V853/part3/03-5_ObjectDetectionModelYolov3DGuide",permalink:"/en/docs/V853/part3/03-5_ObjectDetectionModelYolov3DGuide",draft:!1,unlisted:!1,editUrl:"https://github.com/100askTeam/AllwinnerVisionIC-Docs/tree/main/docs/V853/part3/03-5_ObjectDetectionModelYolov3DGuide.md",tags:[],version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5},sidebar:"v853Sidebar",previous:{title:"\u6a21\u578b\u8f6c\u6362\u5de5\u5177\u5b89\u88c5",permalink:"/en/docs/V853/part3/03-4_ModelConversionToolInstallationGuide"},next:{title:"opencv\u548cffmpeg\u9002\u914d",permalink:"/en/docs/V853/part3/03-6_OpenCVAndFFmpegAdaptationGuide"}},r={},l=[{value:"0.\u524d\u8a00",id:"0\u524d\u8a00",level:2},{value:"1.\u5b89\u88c5NPU\u62d3\u5c55\u5305",id:"1\u5b89\u88c5npu\u62d3\u5c55\u5305",level:2},{value:"2.\u914d\u7f6eyolov3",id:"2\u914d\u7f6eyolov3",level:2},{value:"3.\u6d4b\u8bd5yolov3 Demo",id:"3\u6d4b\u8bd5yolov3-demo",level:2},{value:"4.\u8f6c\u6362yolov3\u6a21\u578b",id:"4\u8f6c\u6362yolov3\u6a21\u578b",level:2},{value:"4.1 \u6a21\u578b\u51c6\u5907",id:"41-\u6a21\u578b\u51c6\u5907",level:3},{value:"4.2\u5bfc\u5165\u6a21\u578b",id:"42\u5bfc\u5165\u6a21\u578b",level:3},{value:"4.3 \u521b\u5efa YML \u6587\u4ef6",id:"43-\u521b\u5efa-yml-\u6587\u4ef6",level:3},{value:"4.4\u91cf\u5316",id:"44\u91cf\u5316",level:3},{value:"4.5 \u9884\u63a8\u7406",id:"45-\u9884\u63a8\u7406",level:3},{value:"4.6 \u5bfc\u51fa\u6a21\u677f\u4ee3\u7801\u4e0e\u6a21\u578b",id:"46-\u5bfc\u51fa\u6a21\u677f\u4ee3\u7801\u4e0e\u6a21\u578b",level:3},{value:"5.\u4f7f\u7528\u8f6c\u6362\u540e\u7684\u6a21\u578b\u6d4b\u8bd5",id:"5\u4f7f\u7528\u8f6c\u6362\u540e\u7684\u6a21\u578b\u6d4b\u8bd5",level:2}];function a(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",p:"p",pre:"pre",...(0,i.a)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.h1,{id:"\u76ee\u6807\u68c0\u6d4b\u6a21\u578byolov3\u90e8\u7f72",children:"\u76ee\u6807\u68c0\u6d4b\u6a21\u578byolov3\u90e8\u7f72"}),"\n",(0,o.jsx)(n.h2,{id:"0\u524d\u8a00",children:"0.\u524d\u8a00"}),"\n",(0,o.jsxs)(n.p,{children:["\u200b\t\u4e0a\u4e00\u8282\u6211\u4eec\u5df2\u7ecf\u5b66\u4e60\u4e86\u5982\u4f55\u914d\u7f6eNPU\u6a21\u578b\u8f6c\u6362\u5de5\u5177\uff0c\u8fd9\u4e00\u7ae0\u8282\u6f14\u793a\u589e\u52a0NPU\u62d3\u5c55\u5305\uff0c\u8be5\u62d3\u5c55\u5305\u5305\u542b",(0,o.jsx)(n.code,{children:"Lenet\u3001YOLOV3"}),"\u6d4b\u8bd5\u7528\u4f8b\uff0c\u5e76\u5b9e\u73b0yolov3\u6a21\u578b\u8f6c\u6362\u90e8\u7f72\u3002"]}),"\n",(0,o.jsxs)(n.p,{children:["NPU\u62d3\u5c55\u5305\u4e0b\u8f7d\u5730\u5740\uff1a",(0,o.jsx)(n.a,{href:"https://www.aw-ol.com/downloads?cat=18",children:"https://www.aw-ol.com/downloads?cat=18"})]}),"\n",(0,o.jsxs)(n.p,{children:["\u5168\u5fd7\u5b98\u65b9NPU\u4ecb\u7ecd\uff1a",(0,o.jsx)(n.a,{href:"https://v853.docs.aw-ol.com/npu/dev_npu/",children:"https://v853.docs.aw-ol.com/npu/dev_npu/"})]}),"\n",(0,o.jsxs)(n.p,{children:["\u8d44\u6e90\u5305\uff1a\uff08\u5305\u542b\u6a21\u578b\u7ed3\u6784\u63cf\u8ff0\u6587\u4ef6",(0,o.jsx)(n.code,{children:"cfg"}),"\u3001\u6743\u91cd\u6587\u4ef6",(0,o.jsx)(n.code,{children:"weights"}),"\u548c\u6d4b\u8bd5\u56fe\u50cf\uff09"]}),"\n",(0,o.jsx)(n.h2,{id:"1\u5b89\u88c5npu\u62d3\u5c55\u5305",children:"1.\u5b89\u88c5NPU\u62d3\u5c55\u5305"}),"\n",(0,o.jsxs)(n.p,{children:["\u200b\t\u8fdb\u5165",(0,o.jsx)(n.a,{href:"https://www.aw-ol.com/downloads?cat=18%E5%90%8E%EF%BC%8C%E4%B8%8B%E8%BD%BDV853%E7%9A%84NPU%E6%8B%93%E5%B1%95%E5%8C%85",children:"https://www.aw-ol.com/downloads?cat=18\u540e\uff0c\u4e0b\u8f7dV853\u7684NPU\u62d3\u5c55\u5305"})]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"image-20230511155647021",src:s(58648).Z+"",width:"1037",height:"92"})}),"\n",(0,o.jsxs)(n.p,{children:["\u5c06\u4e0b\u8f7d",(0,o.jsx)(n.code,{children:"V853 NPU\u6269\u5c55\u8f6f\u4ef6\u5305.gz"}),"\u91cd\u547d\u540d\u4e3a",(0,o.jsx)(n.code,{children:"npu_package.tar.gz"}),"\uff0c\u5e76\u5c06\u8be5\u62d3\u5c55\u5305\u653e\u5728Tina\u6839\u76ee\u5f55\u4e0b\u3002\u5982\u4e0b\u6240\u793a\uff1a"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"book@100ask:~/workspaces/tina-v853-open$ ls\nbrandy  build  buildroot  build.sh  device  kernel  npu_package.tar.gz  openwrt  out  platform  prebuilt  tools\n"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"image-20230511160039793",src:s(9641).Z+"",width:"885",height:"384"})}),"\n",(0,o.jsx)(n.p,{children:"\u5728\u7ec8\u7aef\u4e2d\u89e3\u538bnpu\u62d3\u5c55\u538b\u7f29\u5305"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"book@100ask:~/workspaces/tina-v853-open$ tar xvf npu_package.tar.gz openwrt/package/npu/\n"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"image-20230511160340555",src:s(5053).Z+"",width:"816",height:"700"})}),"\n",(0,o.jsx)(n.p,{children:"\u89e3\u538b\u5b8c\u6210\u540e\uff0c\u62d3\u5c55\u5305\u5c31\u81ea\u52a8\u5b89\u88c5\u5230Tina\u7684\u914d\u7f6e\u4e2d\u3002"}),"\n",(0,o.jsx)(n.h2,{id:"2\u914d\u7f6eyolov3",children:"2.\u914d\u7f6eyolov3"}),"\n",(0,o.jsx)(n.p,{children:"\u200b\t\u91cd\u65b0\u4f7f\u80fdTina\u73af\u5883\u914d\u7f6e\uff0c\u5e76\u52a0\u8f7d\u9009\u4e2d100ASK_V853-PRO\u5f00\u53d1\u677f\u65b9\u6848\u3002"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"book@100ask:~/workspaces/tina-v853-open$ source build/envsetup.sh \n...\nbook@100ask:~/workspaces/tina-v853-open$ lunch\n\nYou're building on Linux\n\nLunch menu... pick a combo:\n     1  v853-100ask-tina\n     2  v853-vision-tina\nWhich would you like? [Default v853-100ask]: 1 \n...\n"})}),"\n",(0,o.jsx)(n.p,{children:"\u8fdb\u5165Tina\u914d\u7f6e\u754c\u9762\uff0c\u8f93\u5165"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"make menuconfig\n"})}),"\n",(0,o.jsx)(n.p,{children:"\u8fdb\u5165\u5982\u4e0b\u76ee\u5f55\uff1a"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"> Allwinner \n\t> NPU\n\t\t< > lenet......................................................... lenet demo (NEW)\n\t\t<*> viplite-driver................................... viplite driver for NPU  (NEW)\n\t\t< > vpm_run................................................ vpm model runner  (NEW)\n\t\t<*> yolov3....................................................... yolov3 demo (NEW)\n\t\t<*>   yolov3-model.............................. yolov3 test demo model (37 MB) \n"})}),"\n",(0,o.jsxs)(n.p,{children:["\u9009\u4e2d",(0,o.jsx)(n.code,{children:"viplite-driver"}),"\u548c",(0,o.jsx)(n.code,{children:"yolov3"}),"\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a"]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"image-20230511162515584",src:s(36438).Z+"",width:"1092",height:"731"})}),"\n",(0,o.jsx)(n.p,{children:"\u9009\u4e2d\u5b8c\u6210\u540e\uff0c\u4fdd\u5b58\u5e76\u9000\u51faTina\u914d\u7f6e\u754c\u9762\u3002"}),"\n",(0,o.jsx)(n.p,{children:"\u200b\tyolov3 Demo\u793a\u4f8b\u7684\u6e90\u7801\u4f4d\u4e8e\uff1atina-v853-open/openwrt/package/npu/yolov3"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"book@100ask:~/workspaces/tina-v853-open/openwrt/package/npu/yolov3$ ls\nMakefile  src\nbook@100ask:~/workspaces/tina-v853-open/openwrt/package/npu/yolov3$ tree\n.\n\u251c\u2500\u2500 Makefile\n\u2514\u2500\u2500 src\n    \u251c\u2500\u2500 bmp.h\n    \u251c\u2500\u2500 box.c\n    \u251c\u2500\u2500 box.h\n    \u251c\u2500\u2500 image_utils.c\n    \u251c\u2500\u2500 image_utils.h\n    \u251c\u2500\u2500 main.c\n    \u251c\u2500\u2500 Makefile\n    \u251c\u2500\u2500 vnn_global.h\n    \u251c\u2500\u2500 vnn_post_process.c\n    \u251c\u2500\u2500 vnn_post_process.h\n    \u251c\u2500\u2500 vnn_pre_process.c\n    \u251c\u2500\u2500 vnn_pre_process.h\n    \u251c\u2500\u2500 yolo_layer.c\n    \u251c\u2500\u2500 yolo_layer.h\n    \u251c\u2500\u2500 yolov3_model.nb\n    \u2514\u2500\u2500 yolo_v3_post_process.c\n\n1 directory, 17 files\n"})}),"\n",(0,o.jsx)(n.h2,{id:"3\u6d4b\u8bd5yolov3-demo",children:"3.\u6d4b\u8bd5yolov3 Demo"}),"\n",(0,o.jsxs)(n.p,{children:["\u6d4b\u8bd5\u524d\u9700\u8981\u51c6\u5907\u4e00\u5f20",(0,o.jsx)(n.code,{children:"416*416"}),"\u683c\u5f0f\u7684\u56fe\u50cf"]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"image-20230511165625823",src:s(97248).Z+"",width:"787",height:"423"})}),"\n",(0,o.jsx)(n.p,{children:"\u5c06\u56fe\u50cf\u4f7f\u7528ADB\u4f20\u5165\u5f00\u53d1\u677f\u4e2d"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"book@100ask:~/workspaces/testImg$ adb push test01.jpg /tmp/\ntest01.jpg: 1 file pushed. 0.5 MB/s (22616 bytes in 0.048s)\n"})}),"\n",(0,o.jsxs)(n.p,{children:["\u8fdb\u5165\u4e32\u53e3\u7ec8\u7aef\u540e\uff0c\u8fdb\u5165",(0,o.jsx)(n.code,{children:"tmp"}),"\u76ee\u5f55\u4e0b"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"root@TinaLinux:~# cd /tmp/\nroot@TinaLinux:/tmp# ls\nUNIX_WIFI.domain  lock              test01.jpg        wpa_ctrl_1067-2\nlib               run               wpa_ctrl_1067-1\n"})}),"\n",(0,o.jsx)(n.p,{children:"\u4f7f\u7528yolov3 Demo\u6d4b\u8bd5\u56fe\u50cf\uff0c\u8f93\u5165"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"root@TinaLinux:/tmp# yolov3 /etc/models/yolov3_model.nb test01.jpg\n"})}),"\n",(0,o.jsx)(n.p,{children:"\u8f93\u5165\u5b8c\u6210\u540e\uff0c\u6d4b\u8bd5\u7a0b\u5e8f\u4f1a\u5c06test01.jpg\u56fe\u50cf\u4f5c\u4e3a\u8f93\u5165\uff0c\u8f93\u51fatest01.jpg\u56fe\u50cf\u7684\u6253\u6846\u56fe\u50cf\u3002\u5c06\u6587\u4ef6\u4f7f\u7528TF\u5361\u7b49\u65b9\u5f0f\u4f20\u5165Windows\u4e2d\u67e5\u770b\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"image-20230511175402808",src:s(89890).Z+"",width:"414",height:"416"})}),"\n",(0,o.jsx)(n.h2,{id:"4\u8f6c\u6362yolov3\u6a21\u578b",children:"4.\u8f6c\u6362yolov3\u6a21\u578b"}),"\n",(0,o.jsx)(n.h3,{id:"41-\u6a21\u578b\u51c6\u5907",children:"4.1 \u6a21\u578b\u51c6\u5907"}),"\n",(0,o.jsxs)(n.p,{children:["\u200b\t\u672c\u6b21\u4f7f\u7528\u7684\u7f51\u4e0a\u4e0b\u8f7d\u7684\u6a21\u578b\uff0c\u540e\u7eed\u5c06\u4f1a\u4f7f\u7528\u5b57\u81ea\u8bad\u7ec3\u751f\u6210\u7684\u6a21\u578b\u3002\u6211\u4eec\u4f7f\u7528\u7684\u6846\u67b6\u662f darknet\uff0c\u6a21\u578b\u4e3a ",(0,o.jsx)(n.code,{children:"YOLOv3-608"}),"\u3002 \u5176\u8bad\u7ec3\u7684\u6570\u636e\u96c6\u662f ",(0,o.jsx)(n.code,{children:"COCO trainval"})," \u6570\u636e\u96c6\uff0c\u6a21\u578b\u53ef\u4ee5\u5728\u8fd9\u91cc\u4e0b\u8f7d\u5230\uff1a",(0,o.jsx)(n.a,{href:"https://pjreddie.com/darknet/yolo/",children:"https://pjreddie.com/darknet/yolo/"})]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"image-20230511181922536",src:s(77925).Z+"",width:"727",height:"581"})}),"\n",(0,o.jsxs)(n.p,{children:["\u5206\u522b\u4e0b\u8f7d\u6a21\u578b\u7ed3\u6784\u63cf\u8ff0\u6587\u4ef6",(0,o.jsx)(n.code,{children:"cfg"}),"\u548c\u6743\u91cd\u6587\u4ef6",(0,o.jsx)(n.code,{children:"weights"}),"\u3002\u5982\u679c\u4e0b\u8f7d\u4e0d\u4e86\uff0c\u53ef\u4ee5\u5728source\u538b\u7f29\u5305\u4e2d\u7684yolov3\u76ee\u5f55\u4e0b\u627e\u5230\u5bf9\u5e94\u6587\u4ef6\u3002"]}),"\n",(0,o.jsxs)(n.p,{children:["\u200b\t\u5c06\u4e0b\u8f7d\u7684\u4e24\u4e2a\u6587\u4ef6\u4f20\u5165\u914d\u7f6e\u597d\u6a21\u578b\u8f6c\u6362\u5de5\u5177\u7684Ubuntu20.04\u4e2d\uff0c\u5047\u8bbe\u4f20\u5165",(0,o.jsx)(n.code,{children:"/home/ubuntu/workspaces"}),"\u76ee\u5f55\u4e0b"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"ubuntu@ubuntu2004:~/workspaces$ ls\nyolov3.cfg  yolov3.weights\n"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"image-20230512112654652",src:s(69430).Z+"",width:"488",height:"465"})}),"\n",(0,o.jsxs)(n.p,{children:["\u200b\t\u4fee\u6539",(0,o.jsx)(n.code,{children:"yolov3.cfg"}),"\u6587\u4ef6\uff0c\u5c06 ",(0,o.jsx)(n.code,{children:"width"})," \u4e0e ",(0,o.jsx)(n.code,{children:"height"})," \u6539\u4e3a ",(0,o.jsx)(n.code,{children:"416"})," \u4ee5\u83b7\u5f97\u66f4\u597d\u7684\u6027\u80fd\u3002"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"ubuntu@ubuntu2004:~/workspaces$ vi yolov3.cfg\n"})}),"\n",(0,o.jsx)(n.p,{children:"\u5c06\u539f\u672c\u7684\u6a21\u578b\u5bbd\u5ea6\u548c\u9ad8\u5ea6608\u4fee\u6539\u4e3a416\u3002"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"image-20230512113414290",src:s(45243).Z+"",width:"511",height:"305"})}),"\n",(0,o.jsxs)(n.p,{children:["\u65b0\u5efa",(0,o.jsx)(n.code,{children:"data"}),"\u6587\u4ef6\u5939\uff0c\u7528\u4e8e\u5b58\u653e\u91cf\u5316\u6240\u9700\u7684\u56fe\u7247\u3002"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"ubuntu@ubuntu2004:~/workspaces$ mkdir data\n"})}),"\n",(0,o.jsxs)(n.p,{children:["\u65b0\u5efa",(0,o.jsx)(n.code,{children:"dataset.txt"}),"\u6587\u4ef6\uff0c\u5199\u5165\u56fe\u7247\u7684\u8def\u5f84\u548c id\u3002"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"ubuntu@ubuntu2004:~/workspaces$ touch dataset.txt\n"})}),"\n",(0,o.jsxs)(n.p,{children:["\u5047\u8bbe\u6211\u5c06\u4e24\u5f20\u91cf\u5316\u56fe\u7247\u653e\u5728",(0,o.jsx)(n.code,{children:"/home/ubuntu/workspaces/data"}),"\u76ee\u5f55\u4e0b\uff0c\u5982\u4e0b\u6240\u793a\uff1a"]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"image-20230512113853903",src:s(3634).Z+"",width:"867",height:"469"})}),"\n",(0,o.jsxs)(n.p,{children:["\u90a3\u4e48\u6b64\u65f6\u9700\u8981\u4fee\u6539",(0,o.jsx)(n.code,{children:"/home/ubuntu/workspaces"}),"\u76ee\u5f55\u4e0b\u7684",(0,o.jsx)(n.code,{children:"dataset.txt"}),"\u6587\u4ef6,"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"ubuntu@ubuntu2004:~/workspaces$ vi dataset.txt\n"})}),"\n",(0,o.jsx)(n.p,{children:"\u4fee\u6539\u8be5\u6587\u4ef6\u7684\u5185\u5bb9\u4e3a\uff1a"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"./data/test01.jpg\n./data/test02.jpg\n"})}),"\n",(0,o.jsx)(n.p,{children:"\u4e0b\u9762\u4e3a\u6240\u6709\u6587\u4ef6\u76ee\u5f55\u7ed3\u6784\uff0c\u53ef\u81ea\u884c\u5bf9\u6bd4\u662f\u5426\u7f3a\u5c11\u5bf9\u5e94\u6587\u4ef6\u3002"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"ubuntu@ubuntu2004:~/workspaces$ tree\n.\n\u251c\u2500\u2500 data\n\u2502\xa0\xa0 \u251c\u2500\u2500 test01.jpg\n\u2502\xa0\xa0 \u2514\u2500\u2500 test02.jpg\n\u251c\u2500\u2500 dataset.txt\n\u251c\u2500\u2500 yolov3.cfg\n\u2514\u2500\u2500 yolov3.weights\n\n1 directory, 5 files\n"})}),"\n",(0,o.jsx)(n.h3,{id:"42\u5bfc\u5165\u6a21\u578b",children:"4.2\u5bfc\u5165\u6a21\u578b"}),"\n",(0,o.jsx)(n.p,{children:"\u200b\t\u5728\u7ec8\u7aef\u8f93\u5165"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"buntu@ubuntu2004:~/workspaces$ pegasus import darknet --model yolov3.cfg --weights yolov3.weights --output-model yolov3.json --output-data yolov3.data\n"})}),"\n",(0,o.jsxs)(n.p,{children:["\u5bfc\u5165\u751f\u6210\u4e24\u4e2a\u6587\u4ef6\uff0c\u5206\u522b\u662f\u662f ",(0,o.jsx)(n.code,{children:"yolov3.data"})," \u548c ",(0,o.jsx)(n.code,{children:"yolov3.json"})," \u6587\u4ef6\uff0c\u4ed6\u4eec\u662f YOLO V3 \u7f51\u7edc\u5bf9\u5e94\u7684\u82af\u539f\u5185\u90e8\u683c\u5f0f\u8868\u793a\u6587\u4ef6\uff0c\u5206\u522b\u5bf9\u5e94\u539f\u59cb\u6a21\u578b\u6587\u4ef6\u7684 ",(0,o.jsx)(n.code,{children:"yolov3.weights"})," \u548c ",(0,o.jsx)(n.code,{children:"yolov3.cfg"})]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"ubuntu@ubuntu2004:~/workspaces$ ls\ndata  dataset.txt  yolov3.cfg  yolov3.data  yolov3.json  yolov3.weights\n"})}),"\n",(0,o.jsx)(n.h3,{id:"43-\u521b\u5efa-yml-\u6587\u4ef6",children:"4.3 \u521b\u5efa YML \u6587\u4ef6"}),"\n",(0,o.jsx)(n.p,{children:"YML \u6587\u4ef6\u5bf9\u7f51\u7edc\u7684\u8f93\u5165\u548c\u8f93\u51fa\u7684\u8d85\u53c2\u6570\u8fdb\u884c\u63cf\u8ff0\u4ee5\u53ca\u914d\u7f6e\uff0c\u8fd9\u4e9b\u53c2\u6570\u5305\u62ec\uff0c\u8f93\u5165\u8f93\u51fa tensor \u7684\u5f62\u72b6\uff0c\u5f52\u4e00\u5316\u7cfb\u6570 (\u5747\u503c\uff0c\u96f6\u70b9)\uff0c\u56fe\u50cf\u683c\u5f0f\uff0ctensor \u7684\u8f93\u51fa\u683c\u5f0f\uff0c\u540e\u5904\u7406\u65b9\u5f0f\u7b49\u7b49"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"pegasus generate inputmeta --model yolov3.json --input-meta-output yolov3_inputmeta.yml\n\npegasus generate postprocess-file --model yolov3.json --postprocess-file-output yolov3_postprocessmeta.yml\n"})}),"\n",(0,o.jsxs)(n.p,{children:["\u6267\u884c\u540e\u751f\u6210",(0,o.jsx)(n.code,{children:"yolov3_inputmeta.yml"}),"\u548c",(0,o.jsx)(n.code,{children:"yolov3_inputmeta.yml"}),"\uff0c\u4fee\u6539",(0,o.jsx)(n.code,{children:"yolov3_inputmeta.yml"})," \u6587\u4ef6\u4e2d\u7684\u7684 ",(0,o.jsx)(n.code,{children:"scale"})," \u53c2\u6570\u4e3a ",(0,o.jsx)(n.code,{children:"0.0039(1/255)"}),"\uff0c\u76ee\u7684\u662f\u5bf9\u8f93\u5165 ",(0,o.jsx)(n.code,{children:"tensor"})," \u8fdb\u884c\u5f52\u4e00\u5316\uff0c\u548c\u7f51\u7edc\u8fdb\u884c\u8bad\u7ec3\u7684\u65f6\u5019\u662f\u5bf9\u5e94\u7684\u3002"]}),"\n",(0,o.jsx)(n.p,{children:"\u5728\u7ec8\u7aef\u8f93\u5165"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"ubuntu@ubuntu2004:~/workspaces$ vi yolov3_inputmeta.yml \n"})}),"\n",(0,o.jsx)(n.p,{children:"\u5c06scale\u7684\u53c2\u6570\u4ece\u539f\u6765\u76841.0\u4fee\u6539\u4e3a0.0039\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"image-20230512143218882",src:s(46360).Z+"",width:"713",height:"753"})}),"\n",(0,o.jsx)(n.h3,{id:"44\u91cf\u5316",children:"4.4\u91cf\u5316"}),"\n",(0,o.jsxs)(n.p,{children:["\u751f\u6210\u4e0b\u91cf\u5316\u8868\u6587\u4ef6\uff0c\u4f7f\u7528\u975e\u5bf9\u79f0\u91cf\u5316\uff0cuint8\uff0c\u4fee\u6539 ",(0,o.jsx)(n.code,{children:"--batch-size"})," \u53c2\u6570\u4e3a\u4f60\u7684 ",(0,o.jsx)(n.code,{children:"dataset.txt"})," \u91cc\u63d0\u4f9b\u7684\u56fe\u7247\u6570\u91cf\u3002"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"pegasus quantize --model yolov3.json --model-data yolov3.data --batch-size 1 --device CPU --with-input-meta yolov3_inputmeta.yml --rebuild --model-quantize yolov3.quantize --quantizer asymmetric_affine --qtype uint8\n"})}),"\n",(0,o.jsx)(n.h3,{id:"45-\u9884\u63a8\u7406",children:"4.5 \u9884\u63a8\u7406"}),"\n",(0,o.jsxs)(n.p,{children:["\u5229\u7528\u524d\u6587\u7684\u91cf\u5316\u8868\u6267\u884c\u9884\u63a8\u7406\uff0c\u5f97\u5230\u63a8\u7406 ",(0,o.jsx)(n.code,{children:"tensor"}),"\uff0cyolov3 \u662f 1 \u8f93\u5165 3 \u8f93\u51fa\u7f51\u7edc\uff0c\u6240\u4ee5\u4e00\u5171\u4ea7\u751f\u4e86 4 \u4e2a ",(0,o.jsx)(n.code,{children:"tensor"})]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"pegasus inference --model yolov3.json --model-data yolov3.data --batch-size 1 --dtype quantized --model-quantize yolov3.quantize --device CPU --with-input-meta yolov3_inputmeta.yml --postprocess-file yolov3_postprocessmeta.yml\n"})}),"\n",(0,o.jsx)(n.h3,{id:"46-\u5bfc\u51fa\u6a21\u677f\u4ee3\u7801\u4e0e\u6a21\u578b",children:"4.6 \u5bfc\u51fa\u6a21\u677f\u4ee3\u7801\u4e0e\u6a21\u578b"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"pegasus export ovxlib --model yolov3.json --model-data yolov3.data --dtype quantized --model-quantize yolov3.quantize --batch-size 1 --save-fused-graph --target-ide-project 'linux64' --with-input-meta yolov3_inputmeta.yml --output-path ovxilb/yolov3/yolov3prj --pack-nbg-unify --postprocess-file yolov3_postprocessmeta.yml --optimize \"VIP9000PICO_PID0XEE\" --viv-sdk ${VIV_SDK}\n"})}),"\n",(0,o.jsxs)(n.p,{children:["\u81f3\u6b64\uff0c\u6a21\u578b\u8f6c\u6362\u5b8c\u6210\uff0c\u751f\u6210\u7684\u6a21\u578b\u5b58\u653e\u5728 ",(0,o.jsx)(n.code,{children:"ovxilb/yolov3_nbg_unify"})," \u6587\u4ef6\u5939\u5185\u3002"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"ubuntu@ubuntu2004:~/workspaces$ ls ovxilb/yolov3_nbg_unify/\nBUILD   makefile.linux  network_binary.nb  vnn_post_process.c  vnn_pre_process.c  vnn_yolov3prj.c  yolov3prj.2012.vcxproj\nmain.c  nbg_meta.json   vnn_global.h       vnn_post_process.h  vnn_pre_process.h  vnn_yolov3prj.h  yolov3prj.vcxproj\n"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"image-20230512144213994",src:s(57262).Z+"",width:"884",height:"467"})}),"\n",(0,o.jsx)(n.h2,{id:"5\u4f7f\u7528\u8f6c\u6362\u540e\u7684\u6a21\u578b\u6d4b\u8bd5",children:"5.\u4f7f\u7528\u8f6c\u6362\u540e\u7684\u6a21\u578b\u6d4b\u8bd5"}),"\n",(0,o.jsx)(n.p,{children:"\u200b\t\u5c06\u6a21\u578b\u901a\u8fc7adb\u6216\u8005TF\u5361\u7684\u65b9\u5f0f\u4f20\u5165\u5f00\u53d1\u677f\u4e2d\uff0c\u4f8b\u5982\u901a\u8fc7ADB\u7684\u65b9\u5f0f\uff1a"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"ubuntu@ubuntu2004:~/workspaces/ovxilb/yolov3_nbg_unify$ adb push network_binary.nb /tmp/\nnetwork_binary.nb: 1 file pushed. 0.8 MB/s (39056704 bytes in 43.893s)\n"})}),"\n",(0,o.jsx)(n.p,{children:"\u200b\t\u4f20\u5165\u6d4b\u8bd5\u56fe\u7247\uff0c\u53ef\u4f7f\u7528adb\u6216\u8005TF\u5361\u7684\u65b9\u5f0f\u4f20\u5165\u5f00\u53d1\u677f\u4e2d\uff0c\u4f8b\u5982\u901a\u8fc7ADB\u7684\u65b9\u5f0f\uff1a"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"buntu@ubuntu2004:~/workspaces/data$ adb push test01.jpg /tmp/\ntest01.jpg: 1 file pushed. 0.6 MB/s (27095 bytes in 0.041s)\nubuntu@ubuntu2004:~/workspaces/data$ adb push test02.jpg \nadb: usage: push requires an argument\nubuntu@ubuntu2004:~/workspaces/data$ adb push test02.jpg /tmp/\ntest02.jpg: 1 file pushed. 0.7 MB/s (30697 bytes in 0.041s)\n"})}),"\n",(0,o.jsxs)(n.p,{children:["\u4f20\u5165\u5b8c\u6210\u540e\uff0c\u8fdb\u5165\u5f00\u53d1\u677f\u7684\u4e32\u53e3\u7ec8\u7aef\uff0c\u8fdb\u5165",(0,o.jsx)(n.code,{children:"/tmp/"}),"\u76ee\u5f55\u4e0b\uff0c\u5373\u53ef\u770b\u5230\u4f20\u5165\u7684\u6587\u4ef6"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"root@TinaLinux:~# cd /tmp/\nroot@TinaLinux:/tmp# ls\nlock                test01.jpg          wpa_ctrl_1067-2\nUNIX_WIFI.domain    network_binary.nb   test02.jpg          \nlib                 run                 wpa_ctrl_1067-1\n"})}),"\n",(0,o.jsxs)(n.p,{children:["\u6d4b\u8bd5",(0,o.jsx)(n.code,{children:"test01.jpg"}),"\uff0c\u8f93\u5165"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"root@TinaLinux:/tmp# yolov3 ./network_binary.nb test01.jpg \n[0xb6f0c560]vip_init[104], [ 1374.785733] npu[4ca][4ca] vipcore, device init..\n\nThe version of Viplite is: 1.8[ 1374.793243] set_vip_power_clk ON\n.0-0-AW-2022-04-21\n[ 1374.801777] enter aw vip mem alloc size 83886080\n[ 1374.811007] aw_vip_mem_alloc vir 0xe2c00000, phy 0x48800000\n[ 1374.817350] npu[4ca][4ca] gckvip_drv_init  kernel logical phy address=0x48800000  virtual =0xe2c00000\nCreate Neural Network: 73.30ms or 73297.75us\nStart run graph [1] times...\nRun the 1 time: 201.00ms or 200999.30us\nvip run network execution time:\nTotal   201.15ms or 201152.98us\nAverage 201.15ms or 201152.98us\ndata_format=2 buff_size=43095\ndata_format=2 buff_size=172380\ndata_format=2 buff_size=689520\ndog  97% 168 394 27 396\ncat  95% 8 209 153 408\n[ 1375.455490] npu[4ca][4ca] gckvip_drv_exit, aw_vip_mem_free\n[ 1375.461792] aw_vip_mem_free vir 0xe2c00000, phy 0x48800000\n[ 1375.467981] aw_vip_mem_free dma_unmap_sg_atrs\n[ 1375.473057] aw_vip_mem_free ion_unmap_kernel\n[ 1375.479885] aw_vip_mem_free ion_free\n[ 1375.484023] aw_vip_mem_free ion_client_destroy\n[ 1375.494199] npu[4ca][4ca] vipcore, device un-init..\n"})}),"\n",(0,o.jsx)(n.p,{children:"\u6d4b\u8bd5\u5b8c\u5c06\u8f93\u51fa\u7684\u6253\u6846\u56fe\u50cf\u4f20\u5165TF\u5361\u4e2d"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"root@TinaLinux:/tmp# mount /dev/mmcblk1p1 /mnt/extsd/\nroot@TinaLinux:/tmp# cp yolo_v3_output.bmp /mnt/extsd/yolo_v3_output-test01.bmp\n"})}),"\n",(0,o.jsxs)(n.p,{children:["\u6d4b\u8bd5",(0,o.jsx)(n.code,{children:"test02.jpg"}),"\uff0c\u8f93\u5165"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"root@TinaLinux:/tmp# yolov3 ./network_binary.nb test02.jpg \n[0xb6f9d560]vip_init[104], [ 1541.123871] npu[4d3][4d3] vipcore, device init..\n\nThe version of Viplite is: 1.8[ 1541.131453] set_vip_power_clk ON\n.0-0-AW-2022-04-21\n[ 1541.139871] enter aw vip mem alloc size 83886080\n[ 1541.148078] aw_vip_mem_alloc vir 0xe2c00000, phy 0x48800000\n[ 1541.154367] npu[4d3][4d3] gckvip_drv_init  kernel logical phy address=0x48800000  virtual =0xe2c00000\nCreate Neural Network: 73.51ms or 73514.38us\nStart run graph [1] times...\nRun the 1 time: 201.01ms or 201008.95us\nvip run network execution time:\nTotal   201.16ms or 201164.50us\nAverage 201.16ms or 201164.50us\ndata_format=2 buff_size=43095\ndata_format=2 buff_size=172380\ndata_format=2 buff_size=689520\nmotorbike  99% 86 313 150 405\nperson  100% 117 294 0 366\n[ 1541.793857] npu[4d3][4d3] gckvip_drv_exit, aw_vip_mem_free\n[ 1541.800091] aw_vip_mem_free vir 0xe2c00000, phy 0x48800000\n[ 1541.806330] aw_vip_mem_free dma_unmap_sg_atrs\n[ 1541.811397] aw_vip_mem_free ion_unmap_kernel\n[ 1541.818379] aw_vip_mem_free ion_free\n[ 1541.822433] aw_vip_mem_free ion_client_destroy\n[ 1541.836550] npu[4d3][4d3] vipcore, device un-init..\n"})}),"\n",(0,o.jsx)(n.p,{children:"\u6d4b\u8bd5\u5b8c\u5c06\u8f93\u51fa\u7684\u6253\u6846\u56fe\u50cf\u4f20\u5165TF\u5361\u4e2d"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"root@TinaLinux:/tmp# cp yolo_v3_output.bmp /mnt/extsd/yolo_v3_output-test02.bmp\n"})}),"\n",(0,o.jsx)(n.p,{children:"\u4f7f\u7528\u7535\u8111\u7aef\u67e5\u770bTF\u4e2d\u7684\u4e24\u5f20\u8f93\u51fa\u56fe\u50cf\u5982\u4e0b\u6240\u793a\uff1a"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"image-20230512151101531",src:s(74441).Z+"",width:"1322",height:"486"})})]})}function p(e={}){const{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(a,{...e})}):a(e)}},58648:(e,n,s)=>{s.d(n,{Z:()=>o});const o=s.p+"assets/images/image-20230511155647021-c5e6a962ffb7cc778f97adb2ae0e25d7.png"},9641:(e,n,s)=>{s.d(n,{Z:()=>o});const o=s.p+"assets/images/image-20230511160039793-2318a0a15983cf9bff691cd14fc140c9.png"},5053:(e,n,s)=>{s.d(n,{Z:()=>o});const o=s.p+"assets/images/image-20230511160340555-bdd620fc9cb509308541b682e436bcf1.png"},36438:(e,n,s)=>{s.d(n,{Z:()=>o});const o=s.p+"assets/images/image-20230511162515584-9e8ade533841bb14074606d2f892faee.png"},97248:(e,n,s)=>{s.d(n,{Z:()=>o});const o=s.p+"assets/images/image-20230511165625823-f643053ab670a3f7e70b6dc1cd052277.png"},89890:(e,n,s)=>{s.d(n,{Z:()=>o});const o=s.p+"assets/images/image-20230511175402808-f4b10fbe087eaa0959eab201fdfaeb44.png"},77925:(e,n,s)=>{s.d(n,{Z:()=>o});const o=s.p+"assets/images/image-20230511181922536-465808960c35b037442f5907199f97fb.png"},69430:(e,n,s)=>{s.d(n,{Z:()=>o});const o=s.p+"assets/images/image-20230512112654652-6b04a2d309a2da5ba623bca4b04c05de.png"},45243:(e,n,s)=>{s.d(n,{Z:()=>o});const o=s.p+"assets/images/image-20230512113414290-c19afed0770d99047ee3f0a66437b4e0.png"},3634:(e,n,s)=>{s.d(n,{Z:()=>o});const o=s.p+"assets/images/image-20230512113853903-9e8a42834aa4d06b6cb766b2e25260fa.png"},46360:(e,n,s)=>{s.d(n,{Z:()=>o});const o=s.p+"assets/images/image-20230512143218882-ebf1578c04a89c569bd7e93d1b4af386.png"},57262:(e,n,s)=>{s.d(n,{Z:()=>o});const o=s.p+"assets/images/image-20230512144213994-02f0e36ded254b127ed2d7a32541e90e.png"},74441:(e,n,s)=>{s.d(n,{Z:()=>o});const o=s.p+"assets/images/image-20230512151101531-bcfdbab9932ec080e42b17b534c56c14.png"},11151:(e,n,s)=>{s.d(n,{Z:()=>c,a:()=>d});var o=s(67294);const i={},t=o.createContext(i);function d(e){const n=o.useContext(t);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),o.createElement(t.Provider,{value:n},e.children)}}}]);